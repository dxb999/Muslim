<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</title>
<style>
  body{font-family:Tahoma,Arial,sans-serif;background:#f5f5f5;margin:0;padding:20px;text-align:center}
  h1{color:#2e7d32;margin:0 0 10px}

  /* Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø­Ø³Ù†Ø§Øª/Ø§Ù„Ø³ÙŠØ¦Ø§Øª */
  .container{display:flex;justify-content:center;gap:40px;flex-wrap:wrap;margin-top:24px}
  .column{background:#fff;padding:20px;width:300px;border-radius:10px;box-shadow:0 0 10px #ccc}
  .column h2{margin:0 0 8px}
  input,button,select{padding:8px;margin:5px;width:80%}
  ul{list-style:none;padding:0;margin:12px 0}
  li{margin-bottom:6px;background:#e0f2f1;padding:8px;border-radius:6px;cursor:pointer}
  .summary{margin:18px 0 24px;font-size:1.1em;color:#333}

  /* ØªØ°ÙƒÙŠØ± */
  .reminder-box{background:#fff3cd;color:#856404;border:1px solid #ffeeba;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
  .reminder-box button{background:#ffc107;border:none;padding:10px 20px;font-size:1em;border-radius:6px;cursor:pointer}

  /* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø¨Ø± */
  .grave-meter-box{background:#fdecea;color:#611a15;border:1px solid #f5c6cb;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
  .progress-container{background:#f8d7da;border-radius:20px;overflow:hidden;height:25px;margin:10px 0}
  .progress-bar{height:100%;width:0%;background:#dc3545;transition:width .45s}

  /* Ø§Ù„ØªØ®ÙÙŠÙ */
  .mitigation-box{background:#e9f3ff;color:#0f3b79;border:1px solid #cfe3ff;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
  .miti-buttons{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
  .miti-buttons button{padding:10px 14px;border:none;border-radius:8px;background:#1976d2;color:#fff;cursor:pointer}
  .miti-note{margin-top:8px;font-size:.95em}

  /* Ø¥Ù†ÙÙˆØ¬Ø±Ø§ÙÙŠÙƒ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ (Ù‚Ø³Ù…Ø§Ù†) */
  .infobox{background:#fff;border:1px solid #eaeaea;color:#1b1b1b;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
  .two-cols{display:grid;grid-template-columns:1fr 1fr;gap:20px}
  @media(max-width:820px){.two-cols{grid-template-columns:1fr}}
  .infosec{border:1px dashed #ebebeb;border-radius:10px;padding:12px}
  .infosec h3{margin:0 0 10px}
  .infogrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:16px;justify-items:center}

  /* Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Ø­Ù„Ù‚Ø© ØªÙ‚Ø¯Ù…) */
  .reason{width:140px;height:170px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;user-select:none}
  .ringwrap{position:relative;width:140px;height:140px}
  .ringwrap .inner{
    position:absolute;inset:28px;border-radius:50%;background:#fff;
    display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:6px;text-align:center;
    box-shadow:0 2px 10px rgba(0,0,0,.08);
  }
  .inner .icon{font-size:30px;line-height:1}
  .inner .title{font-size:14px;color:#222}
  .inner .times{font-size:12px;color:#666}
  .count{position:absolute;bottom:-8px;right:-8px;background:#2e7d32;color:#fff;font-size:12px;border-radius:14px;padding:3px 8px;box-shadow:0 2px 6px rgba(0,0,0,.15)}
  .bad .count{background:#dc3545}
  .svg{transform:rotate(-90deg);filter:drop-shadow(0 0 6px rgba(46,125,50,.25))}
  .bad .svg{filter:drop-shadow(0 0 6px rgba(220,53,69,.25))}
  .track{stroke:#e5e5e5;stroke-width:30;fill:none}
  .prog-good{stroke:url(#gradGood);stroke-width:30;fill:none;transition:stroke-dashoffset .25s;stroke-linecap:round}
  .prog-bad{stroke:url(#gradBad);stroke-width:30;fill:none;transition:stroke-dashoffset .25s;stroke-linecap:round}

  /* Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ */
  .final-judgment-box{background:#e8f5e9;color:#1b5e20;border:1px solid #c8e6c9;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
  .judgment-container{display:flex;justify-content:center;align-items:center;margin:20px 0;gap:30px}
  .judgment-column{width:100px;text-align:center}
  .judgment-meter{width:40px;height:200px;background:#ddd;border-radius:20px;position:relative;overflow:hidden}
  #judgmentIndicator{position:absolute;width:100%;height:0%;bottom:0;background:linear-gradient(to top,#dc3545,#ffc107,#4caf50);transition:height .45s}

  /* ØµÙÙˆÙ ØµØºÙŠØ±Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© */
  .qc-row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;align-items:center}
  .mini-btn{background:#1976d2;color:#fff;border:none;padding:6px 10px;border-radius:8px;cursor:pointer}
</style>
</head>
<body>
  <h1>ğŸ“– Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</h1>

  <!-- Ø§Ù„Ø­Ø³Ù†Ø§Øª / Ø§Ù„Ø³ÙŠØ¦Ø§Øª -->
  <div class="container">
    <div class="column" id="good">
      <h2>âœ… Ø§Ù„Ø­Ø³Ù†Ø§Øª</h2>
      <input type="text" id="goodDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„" />
      <input type="number" id="goodPoints" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø©" />
      <ul id="goodList"></ul>
      <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="goodTotal">0</span></strong>
    </div>

    <div class="column" id="bad">
      <h2>âŒ Ø§Ù„Ø³ÙŠØ¦Ø§Øª</h2>
      <input type="text" id="badDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„" />
      <input type="number" id="badPoints" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø©" />
      <ul id="badList"></ul>
      <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="badTotal">0</span></strong>
    </div>
  </div>

  <div class="summary">âš–ï¸ Ø§Ù„ÙØ§Ø±Ù‚ = <span id="netResult">0</span> Ù†Ù‚Ø·Ø©</div>

  <!-- ØªØ°ÙƒÙŠØ± -->
  <div class="reminder-box">
    <h2>â˜ ï¸ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± â€“ ØªØ°ÙƒÙŠØ± ÙˆØªØ­Ø°ÙŠØ±</h2>
    <p id="reminderText">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„ØªØªØ°ÙƒØ± Ø§Ù„Ø¢Ø®Ø±Ø©...</p>
    <button onclick="showReminder()">Ø°ÙƒØ±Ù†ÙŠ Ø§Ù„ÙŠÙˆÙ…</button>
  </div>

  <!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø¨Ø± -->
  <div class="grave-meter-box">
    <h2>ğŸ“‰ Ø¹Ø¯Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±</h2>
    <div class="progress-container"><div id="graveProgress" class="progress-bar"></div></div>
    <p id="graveLevel">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ø¢Ù…Ù†</p>
  </div>

  <!-- ğŸ§® Ø­Ø³Ù†Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø¨Ø§Ù„ØµÙØ­Ø§Øª ØªÙ‚Ø¯ÙŠØ±ÙŠ) -->
  <div class="infobox" id="quranPagesSimple">
    <h2>ğŸ“– Ø­Ø³Ù†Ø§Øª Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø¨Ø§Ù„ØµÙØ­Ø§Øª)</h2>
    <div class="qc-row">
      <input id="qpsFrom" type="number" min="1" max="604" placeholder="Ù…Ù† ØµÙØ­Ø©" style="width:140px">
      <input id="qpsTo"   type="number" min="1" max="604" placeholder="Ø¥Ù„Ù‰ ØµÙØ­Ø©" style="width:140px">
      <label>Ù…ØªÙˆØ³Ø· Ø­Ø±ÙˆÙ/ØµÙØ­Ø©:
        <input id="qpsAvg" type="number" value="450" min="200" max="2000" style="width:120px">
      </label>
      <button onclick="qpsCalc()" class="mini-btn">Ø§Ø­Ø³Ø¨</button>
    </div>
    <div class="qc-row">
      <div>Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª: <strong id="qpsPages">0</strong></div>
      <div>Ø§Ù„Ø­Ø±ÙˆÙ (ØªÙ‚Ø¯ÙŠØ±ÙŠ): <strong id="qpsLetters">0</strong></div>
      <div>Ø§Ù„Ø­Ø³Ù†Ø§Øª: <strong id="qpsHasanat">0</strong></div>
      <button onclick="qpsAdd()" class="mini-btn" style="background:#2e7d32">Ø£Ø¶Ù Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹</button>
    </div>
  </div>

  <!-- ğŸ“– Ø­Ø³Ù†Ø§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ±Ø© Ø¨Ø¨ÙŠØ§Ù†Ø§ØªÙƒ) -->
  <div class="infobox" id="quranSurahSection">
    <h2>ğŸ“– Ø­Ø³Ù†Ø§Øª Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ±Ø©)</h2>
    <div class="qc-row">
      <select id="surahSelect" style="min-width:220px"></select>
      <button onclick="calcSurahHasanat()" class="mini-btn">Ø§Ø­Ø³Ø¨</button>
    </div>
    <div class="qc-row">
      <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø±ÙˆÙ: <strong id="surahLetters">0</strong></div>
      <div>Ø§Ù„Ø­Ø³Ù†Ø§Øª: <strong id="surahHasanat">0</strong></div>
      <button onclick="addSurahHasanat()" class="mini-btn" style="background:#2e7d32">Ø£Ø¶Ù Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹</button>
    </div>
  </div>

  <!-- Ø¥Ù†ÙÙˆØ¬Ø±Ø§ÙÙŠÙƒ: Ø§Ù„Ø¬Ù†Ø© ÙˆØ§Ù„Ù†Ø§Ø± -->
  <div class="infobox">
    <h2>ğŸ§­ Ø£Ø³Ø¨Ø§Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ù†Ø© ÙˆØ§Ù„Ù†Ø§Ø±</h2>
    <div class="two-cols">
      <div class="infosec">
        <h3>ğŸŒ´ Ø£Ø³Ø¨Ø§Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ù†Ø©</h3>
        <div class="infogrid" id="reasonsGoodGrid"></div>
      </div>
      <div class="infosec">
        <h3>ğŸ”¥ Ø£Ø³Ø¨Ø§Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø§Ø±</h3>
        <div class="infogrid" id="reasonsBadGrid"></div>
      </div>
    </div>
  </div>

  <!-- Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
  <div class="final-judgment-box">
    <h2>ğŸŒŒ Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h2>
    <div class="judgment-container">
      <div class="judgment-column"><h3>ğŸŒ´ Ø§Ù„Ø¬Ù†Ø©</h3></div>
      <div class="judgment-meter"><div id="judgmentIndicator"></div></div>
      <div class="judgment-column"><h3>ğŸ”¥ Ø§Ù„Ù†Ø§Ø±</h3></div>
    </div>
    <p id="judgmentResult">â¬…ï¸ ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØµÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø£Ø¹Ù…Ø§Ù„Ùƒ...</p>
  </div>

<script>
  /* Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Ù† */
  let goodTotal=0, badTotal=0;

  /* Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ØªØ®ÙÙŠÙ */
  const K_GOOD=0.6;
  const MITIGATION_POINTS={tawba:25,surahMulk:10,repayDebt:35,cutNamimah:20};
  let mitigationTotal=0;

  function addEntry(type){
    const desc=document.getElementById(`${type}Desc`).value;
    const points=parseInt(document.getElementById(`${type}Points`).value);
    if(!desc||isNaN(points))return;
    const list=document.getElementById(`${type}List`);
    const li=document.createElement('li');
    li.textContent=`${desc} (${points} Ù†Ù‚Ø·Ø©)`;
    li.onclick=()=>{list.removeChild(li); if(type==='good'){goodTotal-=points;document.getElementById('goodTotal').textContent=goodTotal;} else {badTotal-=points;document.getElementById('badTotal').textContent=badTotal;} updateAll();};
    list.appendChild(li);
    if(type==='good'){goodTotal+=points;document.getElementById('goodTotal').textContent=goodTotal;} else {badTotal+=points;document.getElementById('badTotal').textContent=badTotal;}
    document.getElementById(`${type}Desc`).value=''; document.getElementById(`${type}Points`).value='';
    updateAll();
  }

  function updateAll(){updateNetResult();updateGraveMeter();autoUpdateFinalJudgment();}

  function updateNetResult(){document.getElementById('netResult').textContent = goodTotal - badTotal;}

  function showReminder(){
    const reminders=["ÙƒØ§Ù† Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù† Ø¥Ø°Ø§ Ø°ÙÙƒØ± Ø§Ù„Ù‚Ø¨Ø± Ø¨ÙƒÙ‰ Ø­ØªÙ‰ ØªØ¨ØªÙ„ Ù„Ø­ÙŠØªÙ‡.","Ø§Ù„Ù‚Ø¨Ø± Ø£ÙˆÙ„ Ù…Ù†Ø§Ø²Ù„ Ø§Ù„Ø¢Ø®Ø±Ø©ØŒ ÙØ¥Ù† Ù†Ø¬Ø§ Ù…Ù†Ù‡ ÙÙ…Ø§ Ø¨Ø¹Ø¯Ù‡ Ø£ÙŠØ³Ø±.","Ø£ÙƒØ«Ø±ÙˆØ§ Ù…Ù† Ø°ÙƒØ± Ù‡Ø§Ø¯Ù… Ø§Ù„Ù„Ø°Ø§Øª: Ø§Ù„Ù…ÙˆØª.","Ø§Ù„Ù„Ù‡Ù… Ù‚ÙÙ†Ø§ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±ØŒ ÙˆØ«Ø¨Ù‘ØªÙ†Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„.","Ø§Ø³ØªØ¹Ø¯ÙˆØ§ Ù„Ù„Ù‚Ø¨Ø±ØŒ ÙØ¥Ù† Ø§Ù„Ù„ÙŠÙ„ ÙˆØ§Ù„Ù†Ù‡Ø§Ø± ÙŠØ¹Ù…Ù„Ø§Ù† ÙÙŠÙƒÙ…."];
    document.getElementById('reminderText').textContent = reminders[Math.floor(Math.random()*reminders.length)];
  }

  function canUseMitigation(k){const t=localStorage.getItem('miti_'+k); if(!t) return true; return ((Date.now()-parseInt(t,10))/(1000*60*60))>=24;}
  function markMitigationUsed(k){localStorage.setItem('miti_'+k,Date.now().toString());}
  function applyMitigation(k){
    const note=document.getElementById('mitigationNote');
    if(!MITIGATION_POINTS[k])return;
    if(!canUseMitigation(k)){note.textContent="â³ Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ø³ØªÙØ®Ø¯Ù… Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± 24 Ø³Ø§Ø¹Ø©.";return;}
    mitigationTotal+=MITIGATION_POINTS[k]; markMitigationUsed(k);
    note.textContent="âœ… ØªÙ… Ø§Ù„ØªØ®ÙÙŠÙ. Ø§Ø«Ø¨Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø©."; updateAll();
  }

  function computeGraveRisk(){
    let risk=badTotal - K_GOOD*goodTotal - mitigationTotal;
    if(risk<0)risk=0; if(risk>100)risk=100; return Math.round(risk);
  }
  function updateGraveMeter(){
    const risk=computeGraveRisk();
    document.getElementById('graveProgress').style.width=risk+'%';
    let label="Ø¢Ù…Ù†";
    if(risk>10&&risk<=30)label="ØªØ­Ø°ÙŠØ± Ø¨Ø³ÙŠØ·";
    else if(risk>30&&risk<=60)label="Ø®Ø·Ø± Ù…ØªÙˆØ³Ø· âš ï¸";
    else if(risk>60&&risk<90)label="Ø§Ù‚ØªØ±Ø§Ø¨ Ù…Ù† Ø§Ù„Ø¹Ø°Ø§Ø¨ ğŸ˜Ÿ";
    else if(risk>=90)label="ğŸ”¥ Ø´Ø¯ÙŠØ¯ Ø§Ù„Ø®Ø·Ø± â€“ ØªØ¨ Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†";
    document.getElementById('graveLevel').textContent='Ø§Ù„Ù…Ø³ØªÙˆÙ‰: '+label;
  }

  function autoUpdateFinalJudgment(){
    const net=goodTotal-badTotal;
    let h=50, txt="âš–ï¸ ØªØ¹Ø§Ø¯Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†.";
    if(net>100){h=100;txt="ğŸ¥‡ Ø£Ø¹Ù…Ø§Ù„Ùƒ Ø¹Ø¸ÙŠÙ…Ø©ØŒ ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø¬Ù†Ø© Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡!";}
    else if(net>50){h=80;txt="ğŸŒ¿ Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ø¬Ù†Ø© Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø«Ø¨Ø§Øª.";}
    else if(net>0){h=65;txt="ğŸ¤² Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­.";}
    else if(net===0){h=50;txt="âš–ï¸ ØªØ¹Ø§Ø¯Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†.";}
    else if(net>-30){h=35;txt="â— Ø®Ø·Ø±! Ø±Ø§Ø¬Ø¹ Ù†ÙØ³Ùƒ Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†.";}
    else if(net>-70){h=20;txt="ğŸ”¥ ØªØ³Ø§Ø±Ø¹ Ù†Ø­Ùˆ Ø§Ù„Ø®Ø·Ø±ØŒ Ø¨Ø§Ø¯Ø± Ø¨Ø§Ù„ØªÙˆØ¨Ø©.";}
    else {h=5;txt="ğŸš« Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ù†Ø§Ø± Ø¥Ù† Ù„Ù… ØªØªØ¨ØŒ Ø§Ù„Ù„Ù‡Ù… Ø³Ù„Ù…!";}
    document.getElementById('judgmentIndicator').style.height=h+'%';
    document.getElementById('judgmentResult').textContent=txt;
  }

  /* ===== Ø§Ù„Ø¥Ù†ÙÙˆØ¬Ø±Ø§ÙÙŠÙƒ (20 Ø¶ØºØ·Ø© ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰) ===== */
  const MAX_CLICKS = 20;  // ÙƒÙ„ Ø¶ØºØ·Ø© = 5%
  const REASONS_GOOD=[
    {id:'iman',icon:'ğŸ•‹',label:'Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†',points:25},
    {id:'salah',icon:'ğŸ•Œ',label:'Ø§Ù„ØµÙ„Ø§Ø©',points:20},
    {id:'birr',icon:'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦',label:'Ø¨Ø±Ù‘ Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†',points:18},
    {id:'sadaqa',icon:'ğŸ¤',label:'Ø§Ù„ØµØ¯Ù‚Ø©',points:15},
    {id:'siyam',icon:'ğŸŒ™',label:'Ø§Ù„ØµÙˆÙ…',points:12},
    {id:'silah',icon:'ğŸ§¬',label:'ØµÙ„Ø© Ø§Ù„Ø±Ø­Ù…',points:12}
  ];
  const REASONS_BAD=[
    {id:'kufr',icon:'ğŸš«',label:'Ø§Ù„ÙƒÙØ±/Ø§Ù„Ø´Ø±Ùƒ',points:40},
    {id:'tarkSalah',icon:'â›”ï¸',label:'ØªØ±Ùƒ Ø§Ù„ØµÙ„Ø§Ø©',points:30},
    {id:'uquq',icon:'ğŸ’¢',label:'Ø¹Ù‚ÙˆÙ‚ Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†',points:25},
    {id:'zina',icon:'âš ï¸',label:'Ø§Ù„Ø²Ù†Ø§',points:35},
    {id:'riba',icon:'ğŸ’¸',label:'Ø§Ù„Ø±Ø¨Ø§',points:25},
    {id:'namimahR',icon:'ğŸ—£ï¸',label:'Ø§Ù„Ù†Ù…ÙŠÙ…Ø©',points:15}
  ];
  const clicks={}; // id -> count

  function createReasonEl(r,type,grid){
    clicks[r.id]=0;
    const size=140, r0=40, cx=size/2, cy=size/2, C=2*Math.PI*r0;

    const wrap=document.createElement('div');
    wrap.className='reason '+(type==='bad'?'bad':'good');
    wrap.id='reason_'+r.id;

    const ringwrap=document.createElement('div'); ringwrap.className='ringwrap';
    ringwrap.innerHTML=`
      <svg class="svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
        <defs>
          <linearGradient id="gradGood" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#43a047"/><stop offset="100%" stop-color="#2e7d32"/>
          </linearGradient>
          <linearGradient id="gradBad" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#e53935"/><stop offset="100%" stop-color="#b71c1c"/>
          </linearGradient>
        </defs>
        <circle class="track" cx="${cx}" cy="${cy}" r="${r0}"></circle>
        <circle class="${type==='bad'?'prog-bad':'prog-good'}" id="prog_${r.id}" cx="${cx}" cy="${cy}" r="${r0}"
                stroke-dasharray="${C} ${C}" stroke-dashoffset="${C}" ></circle>
      </svg>
    `;

    const inner=document.createElement('div'); inner.className='inner';
    inner.innerHTML=`
      <div class="icon">${r.icon}</div>
      <div class="title">${r.label}</div>
      <div class="times"><span id="t_${r.id}">0</span>Ã—</div>
    `;
    const count=document.createElement('div'); count.className='count'; count.textContent='0Ã—';

    ringwrap.appendChild(inner);
    ringwrap.appendChild(count);
    wrap.appendChild(ringwrap);

    wrap.onclick=()=>{
      if(clicks[r.id] >= MAX_CLICKS) return;
      clicks[r.id]++;
      const pct = clicks[r.id] / MAX_CLICKS;
      const offset = C * (1 - pct);
      const prog = document.getElementById('prog_'+r.id);
      prog.style.strokeDashoffset = offset;

      document.getElementById('t_'+r.id).textContent = clicks[r.id];
      count.textContent = clicks[r.id]+'Ã—';

      if(type==='good'){ goodTotal += r.points; document.getElementById('goodTotal').textContent=goodTotal; }
      else { badTotal  += r.points; document.getElementById('badTotal').textContent=badTotal; }

      updateAll();
    };

    grid.appendChild(wrap);
  }

  function renderReasons(){
    const gGrid=document.getElementById('reasonsGoodGrid');
    const bGrid=document.getElementById('reasonsBadGrid');
    REASONS_GOOD.forEach(r=>createReasonEl(r,'good',gGrid));
    REASONS_BAD.forEach(r=>createReasonEl(r,'bad',bGrid));
  }

  /* ===== Ø§Ù„Ø­Ø³Ù†Ø§Øª Ø¨Ø§Ù„ØµÙØ­Ø§Øª (ØªÙ‚Ø¯ÙŠØ±ÙŠ) ===== */
  function qpsCalc(){
    const f = parseInt(document.getElementById('qpsFrom').value,10);
    const t = parseInt(document.getElementById('qpsTo').value,10);
    const avg = Math.max(0, parseInt(document.getElementById('qpsAvg').value,10) || 0);
    if(isNaN(f)||isNaN(t)||f<1||t<1||f>604||t>604){ alert('Ø±Ø¬Ø§Ø¡ Ø£Ø¯Ø®Ù„ Ø£Ø±Ù‚Ø§Ù… ØµÙØ­Ø§Øª ØµØ­ÙŠØ­Ø© Ø¨ÙŠÙ† 1 Ùˆ 604.'); return; }
    const from = Math.min(f,t), to = Math.max(f,t);
    const pages = (to-from+1);
    const letters = pages * avg;
    const hasanat = letters * 10;
    document.getElementById('qpsPages').textContent   = pages.toString();
    document.getElementById('qpsLetters').textContent = letters.toLocaleString('ar-EG');
    document.getElementById('qpsHasanat').textContent = hasanat.toLocaleString('ar-EG');
    window._QPS_LAST = {from,to,pages,letters,hasanat};
  }
  function qpsAdd(){
    if(!window._QPS_LAST){ qpsCalc(); if(!window._QPS_LAST) return; }
    const h = window._QPS_LAST.hasanat||0;
    if(h<=0){ alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªÙŠØ¬Ø© Ù…Ø­Ø³ÙˆØ¨Ø© Ù„Ø¥Ø¶Ø§ÙØªÙ‡Ø§.'); return; }
    goodTotal += h; document.getElementById('goodTotal').textContent = goodTotal; updateAll();
    alert(`Ø£ÙØ¶ÙŠÙ ${h.toLocaleString('ar-EG')} Ø­Ø³Ù†Ø© Ø¹Ù† Ø§Ù„ØµÙØ­Ø§Øª ${window._QPS_LAST.from}â€“${window._QPS_LAST.to}.`);
  }
  ['qpsFrom','qpsTo','qpsAvg'].forEach(id=>{
    document.addEventListener('input',e=>{
      if(e.target && e.target.id===id){ if(id==='qpsAvg' && (+e.target.value<=0||e.target.value==='')) return; qpsCalc(); }
    });
  });

  /* ===== Ø§Ù„Ø­Ø³Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ±Ø© (Ø¨Ø¨ÙŠØ§Ù†Ø§ØªÙƒ) ===== */
  const surahData = [
    {name:"Ø§Ù„ÙØ§ØªØ­Ø©", letters:143},
    {name:"Ø§Ù„Ø¨Ù‚Ø±Ø©", letters:26246},
    {name:"Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†", letters:14985},
    {name:"Ø§Ù„Ù†Ø³Ø§Ø¡", letters:16334},
    {name:"Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©", letters:12206},
    {name:"Ø§Ù„Ø£Ù†Ø¹Ø§Ù…", letters:12727},
    {name:"Ø§Ù„Ø£Ø¹Ø±Ø§Ù", letters:14439},
    {name:"Ø§Ù„Ø£Ù†ÙØ§Ù„", letters:5383},
    {name:"Ø§Ù„ØªÙˆØ¨Ø©", letters:11115},
    {name:"ÙŠÙˆÙ†Ø³", letters:7589},
    {name:"Ù‡ÙˆØ¯", letters:7818},
    {name:"ÙŠÙˆØ³Ù", letters:7307},
    {name:"Ø§Ù„Ø±Ø¹Ø¯", letters:3545},
    {name:"Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", letters:3539},
    {name:"Ø§Ù„Ø­Ø¬Ø±", letters:2882},
    {name:"Ø§Ù„Ù†Ø­Ù„", letters:7832},
    {name:"Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡", letters:6643},
    {name:"Ø§Ù„ÙƒÙ‡Ù", letters:6552},
    {name:"Ù…Ø±ÙŠÙ…", letters:3935},
    {name:"Ø·Ù‡", letters:5399},
    {name:"Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡", letters:5094},
    {name:"Ø§Ù„Ø­Ø¬", letters:5314},
    {name:"Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†", letters:4483},
    {name:"Ø§Ù„Ù†ÙˆØ±", letters:5754},
    {name:"Ø§Ù„ÙØ±Ù‚Ø§Ù†", letters:3877},
    {name:"Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡", letters:5630},
    {name:"Ø§Ù„Ù†Ù…Ù„", letters:4792},
    {name:"Ø§Ù„Ù‚ØµØµ", letters:5931},
    {name:"Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª", letters:4317},
    {name:"Ø§Ù„Ø±ÙˆÙ…", letters:3473},
    {name:"Ù„Ù‚Ù…Ø§Ù†", letters:2171},
    {name:"Ø§Ù„Ø³Ø¬Ø¯Ø©", letters:1563},
    {name:"Ø§Ù„Ø£Ø­Ø²Ø§Ø¨", letters:5788},
    {name:"Ø³Ø¨Ø£", letters:3594},
    {name:"ÙØ§Ø·Ø±", letters:3238},
    {name:"ÙŠØ³", letters:3068},
    {name:"Ø§Ù„ØµØ§ÙØ§Øª", letters:3899},
    {name:"Øµ", letters:3066},
    {name:"Ø§Ù„Ø²Ù…Ø±", letters:4869},
    {name:"ØºØ§ÙØ±", letters:5108},
    {name:"ÙØµÙ„Øª", letters:3364},
    {name:"Ø§Ù„Ø´ÙˆØ±Ù‰", letters:3522},
    {name:"Ø§Ù„Ø²Ø®Ø±Ù", letters:3610},
    {name:"Ø§Ù„Ø¯Ø®Ø§Ù†", letters:1474},
    {name:"Ø§Ù„Ø¬Ø§Ø«ÙŠØ©", letters:2085},
    {name:"Ø§Ù„Ø£Ø­Ù‚Ø§Ù", letters:2667},
    {name:"Ù…Ø­Ù…Ø¯", letters:2423},
    {name:"Ø§Ù„ÙØªØ­", letters:2510},
    {name:"Ø§Ù„Ø­Ø¬Ø±Ø§Øª", letters:1533},
    {name:"Ù‚", letters:1507},
    {name:"Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª", letters:1546},
    {name:"Ø§Ù„Ø·ÙˆØ±", letters:1324},
    {name:"Ø§Ù„Ù†Ø¬Ù…", letters:1433},
    {name:"Ø§Ù„Ù‚Ù…Ø±", letters:1469},
    {name:"Ø§Ù„Ø±Ø­Ù…Ù†", letters:1648},
    {name:"Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©", letters:1756},
    {name:"Ø§Ù„Ø­Ø¯ÙŠØ¯", letters:2545},
    {name:"Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©", letters:2046},
    {name:"Ø§Ù„Ø­Ø´Ø±", letters:1970},
    {name:"Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©", letters:1560},
    {name:"Ø§Ù„ØµÙ", letters:966},
    {name:"Ø§Ù„Ø¬Ù…Ø¹Ø©", letters:768},
    {name:"Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†", letters:801},
    {name:"Ø§Ù„ØªØºØ§Ø¨Ù†", letters:1091},
    {name:"Ø§Ù„Ø·Ù„Ø§Ù‚", letters:1203},
    {name:"Ø§Ù„ØªØ­Ø±ÙŠÙ…", letters:1105},
    {name:"Ø§Ù„Ù…Ù„Ùƒ", letters:1347},
    {name:"Ø§Ù„Ù‚Ù„Ù…", letters:1288},
    {name:"Ø§Ù„Ø­Ø§Ù‚Ø©", letters:1133},
    {name:"Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬", letters:971},
    {name:"Ù†ÙˆØ­", letters:965},
    {name:"Ø§Ù„Ø¬Ù†", letters:1109},
    {name:"Ø§Ù„Ù…Ø²Ù…Ù„", letters:854},
    {name:"Ø§Ù„Ù…Ø¯Ø«Ø±", letters:1035},
    {name:"Ø§Ù„Ù‚ÙŠØ§Ù…Ø©", letters:677},
    {name:"Ø§Ù„Ø¥Ù†Ø³Ø§Ù†", letters:1087},
    {name:"Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª", letters:841},
    {name:"Ø§Ù„Ù†Ø¨Ø£", letters:796},
    {name:"Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª", letters:785},
    {name:"Ø¹Ø¨Ø³", letters:552},
    {name:"Ø§Ù„ØªÙƒÙˆÙŠØ±", letters:435},
    {name:"Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±", letters:333},
    {name:"Ø§Ù„Ù…Ø·ÙÙÙŠÙ†", letters:751},
    {name:"Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚", letters:445},
    {name:"Ø§Ù„Ø¨Ø±ÙˆØ¬", letters:469},
    {name:"Ø§Ù„Ø·Ø§Ø±Ù‚", letters:254},
    {name:"Ø§Ù„Ø£Ø¹Ù„Ù‰", letters:296},
    {name:"Ø§Ù„ØºØ§Ø´ÙŠØ©", letters:382},
    {name:"Ø§Ù„ÙØ¬Ø±", letters:584},
    {name:"Ø§Ù„Ø¨Ù„Ø¯", letters:342},
    {name:"Ø§Ù„Ø´Ù…Ø³", letters:253},
    {name:"Ø§Ù„Ù„ÙŠÙ„", letters:314},
    {name:"Ø§Ù„Ø¶Ø­Ù‰", letters:165},
    {name:"Ø§Ù„Ø´Ø±Ø­", letters:102},
    {name:"Ø§Ù„ØªÙŠÙ†", letters:162},
    {name:"Ø§Ù„Ø¹Ù„Ù‚", letters:288},
    {name:"Ø§Ù„Ù‚Ø¯Ø±", letters:115},
    {name:"Ø§Ù„Ø¨ÙŠÙ†Ø©", letters:404},
    {name:"Ø§Ù„Ø²Ù„Ø²Ù„Ø©", letters:158},
    {name:"Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª", letters:169},
    {name:"Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©", letters:159},
    {name:"Ø§Ù„ØªÙƒØ§Ø«Ø±", letters:123},
    {name:"Ø§Ù„Ø¹ØµØ±", letters:73},
    {name:"Ø§Ù„Ù‡Ù…Ø²Ø©", letters:134},
    {name:"Ø§Ù„ÙÙŠÙ„", letters:97},
    {name:"Ù‚Ø±ÙŠØ´", letters:77},
    {name:"Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†", letters:114},
    {name:"Ø§Ù„ÙƒÙˆØ«Ø±", letters:43},
    {name:"Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†", letters:99},
    {name:"Ø§Ù„Ù†ØµØ±", letters:80},
    {name:"Ø§Ù„Ù…Ø³Ø¯", letters:81},
    {name:"Ø§Ù„Ø¥Ø®Ù„Ø§Øµ", letters:47},
    {name:"Ø§Ù„ÙÙ„Ù‚", letters:73},
    {name:"Ø§Ù„Ù†Ø§Ø³", letters:80}
  ];

  (function fillSurahSelect(){
    const sel = document.getElementById("surahSelect");
    surahData.forEach((s, i) => {
      let opt = document.createElement("option");
      opt.value = i;
      opt.textContent = `${i+1} - ${s.name}`;
      sel.appendChild(opt);
    });
  })();

  function calcSurahHasanat() {
    const sel = document.getElementById("surahSelect");
    if(sel.value===""){ return; }
    const letters = surahData[+sel.value].letters;
    const hasanat = letters * 10;
    document.getElementById("surahLetters").textContent = letters.toLocaleString('ar-EG');
    document.getElementById("surahHasanat").textContent = hasanat.toLocaleString('ar-EG');
  }

  function addSurahHasanat() {
    const txt = document.getElementById("surahHasanat").textContent.replace(/[^\d]/g,'');
    const h = parseInt(txt||'0',10);
    if(h<=0){ alert('Ø§Ø­Ø³Ø¨ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø£Ø¶Ù Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹.'); return; }
    goodTotal += h; document.getElementById('goodTotal').textContent = goodTotal; updateAll();
    alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø­Ø³Ù†Ø§Øª.');
  }

  /* ØªØ´ØºÙŠÙ„ */
  window.onload=()=>{ renderReasons(); updateAll(); populateDropdowns(); };

  /* Ù‚ÙˆØ§Ø¦Ù… Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ø­Ø³Ù†Ø§Øª/Ø§Ù„Ø³ÙŠØ¦Ø§Øª */
  const goodActions = [
    { text: "ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± ÙÙŠ ÙˆÙ‚ØªÙ‡Ø§", points: 20 },
    { text: "Ø§Ù„ØµØ¯Ù‚Ø© Ø¹Ù„Ù‰ Ù…Ø­ØªØ§Ø¬", points: 15 },
    { text: "Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†", points: 10 },
    { text: "Ø¨Ø± Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†", points: 25 },
    { text: "Ø§Ù„Ø§Ø¨ØªØ³Ø§Ù…Ø© ÙÙŠ ÙˆØ¬Ù‡ Ø£Ø®ÙŠÙƒ", points: 5 },
    { text: "Ø§Ù„Ø§Ø³ØªØºÙØ§Ø± 100 Ù…Ø±Ø©", points: 12 },
    { text: "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„", points: 18 }
  ];
  const badActions = [
    { text: "Ø§Ù„ÙƒØ°Ø¨", points: 10 },
    { text: "Ø§Ù„Ù†Ù…ÙŠÙ…Ø©", points: 15 },
    { text: "ØªØ±Ùƒ Ø§Ù„ØµÙ„Ø§Ø©", points: 25 },
    { text: "Ø¥ÙŠØ°Ø§Ø¡ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†", points: 12 },
    { text: "Ø³Ù…Ø§Ø¹ Ø§Ù„Ø­Ø±Ø§Ù…", points: 8 },
    { text: "Ù†Ø¸Ø± Ù…Ø­Ø±Ù…", points: 7 },
    { text: "Ø§Ù„ØºÙŠØ¨Ø©", points: 15 }
  ];
  function populateDropdowns() {
    const goodSelect = document.createElement("select");
    goodSelect.id = "goodSelect";
    goodSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø¹Ù…Ù„Ù‹Ø§ Ø­Ø³Ù†Ù‹Ø§</option>';
    goodActions.forEach(action => {
      const option = document.createElement("option");
      option.value = action.points;
      option.textContent = `${action.text} (+${action.points})`;
      goodSelect.appendChild(option);
    });
    const goodBtn = document.createElement("button");
    goodBtn.textContent = "Ø¥Ø¶Ø§ÙØ©";
    goodBtn.className='mini-btn';
    goodBtn.onclick = () => {
      const selected = goodSelect.options[goodSelect.selectedIndex];
      if (selected.value) {
        document.getElementById("goodDesc").value = selected.textContent;
        document.getElementById("goodPoints").value = selected.value;
        addEntry('good');
      }
    };

    const badSelect = document.createElement("select");
    badSelect.id = "badSelect";
    badSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø¹Ù…Ù„Ù‹Ø§ Ø³ÙŠØ¦Ù‹Ø§</option>';
    badActions.forEach(action => {
      const option = document.createElement("option");
      option.value = action.points;
      option.textContent = `${action.text} (-${action.points})`;
      badSelect.appendChild(option);
    });
    const badBtn = document.createElement("button");
    badBtn.textContent = "Ø¥Ø¶Ø§ÙØ©";
    badBtn.className='mini-btn';
    badBtn.onclick = () => {
      const selected = badSelect.options[badSelect.selectedIndex];
      if (selected.value) {
        document.getElementById("badDesc").value = selected.textContent;
        document.getElementById("badPoints").value = selected.value;
        addEntry('bad');
      }
    };

    document.getElementById("good").appendChild(goodSelect);
    document.getElementById("good").appendChild(goodBtn);
    document.getElementById("bad").appendChild(badSelect);
    document.getElementById("bad").appendChild(badBtn);
  }
</script>
</body>
</html>
