<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</title>
  <style>
    body{font-family:Tahoma,Arial,sans-serif;background:#f5f5f5;margin:0;padding:20px;text-align:center}
    h1{color:#2e7d32}

    .container{display:flex;justify-content:center;gap:40px;margin-top:30px;flex-wrap:wrap}
    .column{background:#fff;padding:20px;width:300px;border-radius:10px;box-shadow:0 0 10px #ccc}
    .column h2{margin-top:0}
    input,button,select{padding:8px;margin:5px;width:80%}
    ul{list-style:none;padding:0;margin:15px 0}
    li{margin-bottom:5px;background:#e0f2f1;padding:8px;border-radius:5px;cursor:pointer}
    .summary{margin-top:30px;font-size:1.2em;color:#333}

    /* ØªØ°ÙƒÙŠØ± */
    .reminder-box{background:#fff3cd;color:#856404;border:1px solid #ffeeba;padding:20px;margin:40px auto 20px;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .reminder-box button{background:#ffc107;border:none;padding:10px 20px;font-size:1em;border-radius:5px;cursor:pointer}

    /* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø¨Ø± + Ø§Ù„ØªØ®ÙÙŠÙ */
    .grave-meter-box{background:#fdecea;color:#611a15;border:1px solid #f5c6cb;padding:20px;margin:30px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .progress-container{background:#f8d7da;border-radius:20px;overflow:hidden;height:25px;margin:10px 0}
    .progress-bar{height:100%;width:0%;background:#dc3545;transition:width .5s}
    .mitigation-box{background:#e9f3ff;color:#0f3b79;border:1px solid #cfe3ff;padding:20px;margin:30px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .miti-buttons{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .miti-buttons button{padding:10px 14px;border:none;border-radius:8px;background:#1976d2;color:#fff;cursor:pointer}
    .miti-note{margin-top:8px;font-size:.95em}

    /* --- ÙƒØ±Ø§Ù…Ø§Øª/ØªØ­Ø°ÙŠØ±Ø§Øª/Ù…Ø´Ø§Ù‡Ø¯ --- */
    .day-honors,.day-warnings,.day-scenes{background:#fff;border:1px solid #eaeaea;padding:20px;margin:30px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .day-honors h2,.day-warnings h2,.day-scenes h2{margin:0 0 8px}
    .honors-grid,.warnings-grid,.scenes-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:18px;justify-items:center}
    .honor-card,.warn-card,.scene-card{width:160px;display:flex;flex-direction:column;align-items:center;gap:8px}
    .ringwrap{position:relative;width:140px;height:140px}
    .inner{position:absolute;inset:28px;border-radius:50%;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:6px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .inner .icon{font-size:26px}
    .inner .title{font-size:14px;color:#222}
    .inner .meta{font-size:12px;color:#666}
    .help{position:absolute;top:-6px;left:-6px;background:#00000080;color:#fff;width:20px;height:20px;border-radius:50%;display:grid;place-items:center;font-size:12px;cursor:pointer}
    .count-badge{position:absolute;bottom:-6px;right:-6px;background:#2e7d32;color:#fff;font-size:12px;border-radius:12px;padding:2px 6px;box-shadow:0 2px 6px rgba(0,0,0,.15)}
    .count-badge.bad{background:#dc3545}
    .track{stroke:#e5e5e5;stroke-width:30;fill:none}
    .prog-good{stroke-width:30;fill:none;transition:stroke-dashoffset .35s;filter:drop-shadow(0 0 8px rgba(46,125,50,.6))}
    .prog-bad {stroke-width:30;fill:none;transition:stroke-dashoffset .35s;filter:drop-shadow(0 0 8px rgba(220,53,69,.6))}
    .prog-info{stroke-width:30;fill:none;transition:stroke-dashoffset .35s;filter:drop-shadow(0 0 8px rgba(33,150,243,.6))}
    .svg{transform:rotate(-90deg)}

    /* Ø¥Ù†ÙÙˆØ¬Ø±Ø§ÙÙŠÙƒ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ (Ù‚Ø³Ù…Ø§Ù†) */
    .infobox{background:#fff;border:1px solid #eaeaea;color:#1b1b1b;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .two-cols{display:grid;grid-template-areas:"good bad";gap:20px}
    .sec-good{grid-area:good}
    .sec-bad{grid-area:bad}
    @media(max-width:820px){.two-cols{grid-template-areas:"good" "bad"}}
    .infosec{border:1px dashed #ebebeb;border-radius:10px;padding:12px}
    .infosec h3{margin:0 0 10px}
    .infogrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:16px;justify-items:center}

    /* Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ (Ø¹Ø±Ø¶ 30 + ØªØ¯Ø±Ø¬ + Ù„Ù…Ø¹Ø©) */
    .reason{width:140px;height:170px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;user-select:none}
    .ringwrap .reason-inner{position:absolute;inset:28px;border-radius:50%;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:6px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .reason .icon{font-size:30px;line-height:1}
    .reason .title{font-size:14px;color:#222}
    .reason .times{font-size:12px;color:#666}
    .count{position:absolute;bottom:-8px;right:-8px;background:#2e7d32;color:#fff;font-size:12px;border-radius:14px;padding:3px 8px;box-shadow:0 2px 6px rgba(0,0,0,.15)}
    .bad .count{background:#dc3545}
    .track-r{stroke:#e5e5e5;stroke-width:30;fill:none}
    .prog-good-r{stroke-width:30;fill:none;transition:stroke-dashoffset .25s;filter:drop-shadow(0 0 8px rgba(46,125,50,.6))}
    .prog-bad-r {stroke-width:30;fill:none;transition:stroke-dashoffset .25s;filter:drop-shadow(0 0 8px rgba(220,53,69,.6))}
    .svg-r{transform:rotate(-90deg)}

    /* Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ */
    .final-judgment-box{background:#e8f5e9;color:#1b5e20;border:1px solid #c8e6c9;padding:20px;margin:22px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .judgment-container{display:flex;justify-content:center;align-items:center;margin:20px 0;gap:30px}
    .judgment-column{width:100px;text-align:center}
    .judgment-meter{width:40px;height:200px;background:#ddd;border-radius:20px;position:relative;overflow:hidden}
    #judgmentIndicator{position:absolute;width:100%;height:0%;bottom:0;background:linear-gradient(to top,#dc3545,#ffc107,#4caf50);transition:height .45s}

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø±Ø­ (Popup) */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:1000}
    .modal.active{display:flex}
    .modal .card{background:#fff;width:min(560px,92%);border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,.25);overflow:hidden;text-align:right}
    .modal .card header{background:#2e7d32;color:#fff;padding:12px 16px;font-weight:bold}
    .modal .card .content{padding:16px;font-size:15px;color:#222;line-height:1.7}
    .modal .card footer{padding:12px 16px;text-align:left}
    .modal .card footer button{padding:8px 14px;border:none;background:#2e7d32;color:#fff;border-radius:8px;cursor:pointer}

    /* Ù‚Ø³Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† */
    .quran-box{background:#fff;border:1px solid #eaeaea;padding:20px;margin:30px auto;width:80%;border-radius:10px;box-shadow:0 0 10px #ccc}
    .q-head{margin:0 0 10px}
    .q-controls{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-items:center;margin-bottom:10px}
    .q-controls select,.q-controls input{width:auto;min-width:140px}
    .q-stats{margin-top:8px;color:#333}
    .q-progress{background:#eee;border-radius:10px;overflow:hidden;height:14px;margin:10px auto;width:min(520px,90%)}
    .q-bar{height:100%;width:0%;transition:width .4s;background:linear-gradient(90deg,#2e7d32,#66bb6a)}
    .q-actions{margin-top:10px}
    .q-actions button{padding:8px 12px;border:none;border-radius:8px;background:#2e7d32;color:#fff;cursor:pointer}
  </style>
</head>
<body>
  <h1>ğŸ“– Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</h1>

  <!-- Ø§Ù„Ø­Ø³Ù†Ø§Øª / Ø§Ù„Ø³ÙŠØ¦Ø§Øª -->
  <div class="container">
    <div class="column" id="good">
      <h2>âœ… Ø§Ù„Ø­Ø³Ù†Ø§Øª</h2>
      <input type="text" id="goodDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„" />
      <input type="number" id="goodPoints" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø©" />
      <button onclick="addEntry('good')">Ø¥Ø¶Ø§ÙØ©</button>
      <ul id="goodList"></ul>
      <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="goodTotal">0</span></strong>
    </div>
    <div class="column" id="bad">
      <h2>âŒ Ø§Ù„Ø³ÙŠØ¦Ø§Øª</h2>
      <input type="text" id="badDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„" />
      <input type="number" id="badPoints" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø©" />
      <button onclick="addEntry('bad')">Ø¥Ø¶Ø§ÙØ©</button>
      <ul id="badList"></ul>
      <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="badTotal">0</span></strong>
    </div>
  </div>

  <div class="summary">âš–ï¸ Ø§Ù„ÙØ§Ø±Ù‚ = <span id="netResult">0</span> Ù†Ù‚Ø·Ø©</div>

  <!-- ØªØ°ÙƒÙŠØ± -->
  <div class="reminder-box">
    <h2>â˜ ï¸ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± â€“ ØªØ°ÙƒÙŠØ± ÙˆØªØ­Ø°ÙŠØ±</h2>
    <p id="reminderText">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„ØªØªØ°ÙƒØ± Ø§Ù„Ø¢Ø®Ø±Ø©...</p>
    <button onclick="showReminder()">Ø°ÙƒØ±Ù†ÙŠ Ø§Ù„ÙŠÙˆÙ…</button>
  </div>

<!-- ======= Ù…Ø¤Ø´Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ØµÙ„Ø§Ø© (Ø¥Ù„ØµÙ‚Ù‡ Ø­ÙŠØ« ØªØ±ÙŠØ¯ Ø¯Ø§Ø®Ù„ Ø§Ù„ØµÙØ­Ø©) ======= -->
<section id="prayerSection" dir="rtl" style="font-family: Tahoma, Arial, sans-serif;">
  <style>
    #prayerSection *{box-sizing:border-box}
    #prayerSection .wrap{max-width:980px;margin:24px auto;background:#fff;border:1px solid #eee;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:20px}
    #prayerSection h2{margin:0 0 6px;font-size:28px}
    #prayerSection .sub{color:#666;margin:2px 0 14px}
    /* Ø±Ø£Ø³ Ù…Ø¹ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø£Ø³ÙŠ */
    #prayerSection .head{display:flex;gap:16px;align-items:center;justify-content:space-between}
    #prayerSection .meterBox{display:flex;align-items:center;gap:14px}
    #prayerSection .meter{width:56px;height:220px;border:1.5px solid #d9d9d9;border-radius:14px;padding:6px;display:flex;flex-direction:column;justify-content:flex-end;background:#fafafa}
    #prayerSection .bar{width:100%;height:0;border-radius:10px;background:linear-gradient(#ef4444 0%, #f59e0b 50%, #22c55e 100%);transition:height .45s}
    #prayerSection .levelTag{display:flex;flex-direction:column;align-items:center;font-weight:700;color:#333}
    #prayerSection .levelPill{border:1px solid #e5e5e5;border-radius:12px;padding:4px 10px;margin-top:6px;background:#f8f8f8}
    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù‡Ø§Ù… */
    #prayerSection .grid{display:grid;grid-template-columns:1fr 1fr;gap:22px;margin-top:18px}
    @media(max-width:820px){#prayerSection .grid{grid-template-columns:1fr}}
    #prayerSection .panel{border:1px dashed #ececec;border-radius:12px;padding:14px}
    #prayerSection .panel h3{margin:0 0 8px}
    #prayerSection .tasks{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:18px;justify-items:center}
    /* Ø¨Ø·Ø§Ù‚Ø© Ù…Ù‡Ù…Ø© */
    #prayerSection .task{width:160px;display:flex;flex-direction:column;align-items:center;gap:8px;user-select:none;cursor:pointer}
    #prayerSection .ringwrap{position:relative;width:140px;height:140px}
    /* Ø­Ù„Ù‚Ø© Ø³Ù…ÙŠÙƒØ© + Ù„Ù…Ø¹Ø© */
    #prayerSection .svg{transform:rotate(-90deg)}
    #prayerSection .track{stroke:#ececec;stroke-width:30;fill:none}
    #prayerSection .prog{stroke-width:30;fill:none;stroke-linecap:round;filter:drop-shadow(0 0 8px rgba(34,197,94,.55));transition:stroke-dashoffset .3s}
    #prayerSection .prog.badFx{filter:drop-shadow(0 0 8px rgba(239,68,68,.55))}
    /* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© */
    #prayerSection .inner{position:absolute;inset:28px;border-radius:50%;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:6px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    #prayerSection .icon{font-size:30px;line-height:1}
    #prayerSection .title{font-size:15px;color:#222}
    #prayerSection .count{position:absolute;bottom:-8px;right:-8px;background:#22c55e;color:#fff;font-size:12px;border-radius:14px;padding:3px 8px;box-shadow:0 2px 6px rgba(0,0,0,.15)}
    #prayerSection .count.bad{background:#ef4444}
    /* Ø£Ø±Ù‚Ø§Ù… Ø¹Ø§Ù…Ø© */
    #prayerSection .scoreLine{font-size:18px;margin:10px 0 0}
    #prayerSection .scoreLine b{font-size:22px}
    #prayerSection .hint{color:#777;font-size:13px;margin-top:6px}
  </style>

  <div class="wrap">
    <div class="head">
      <div>
        <h2>ğŸ•Œ Ù…Ø¤Ø´Ø± Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ØµÙ„Ø§Ø©</h2>
        <div class="sub">Ø§Ù„Ø³ÙÙ‘ØªÙˆ: <span id="prayerLevelText">Ù…ØªÙˆØ³Ø·</span> â€“ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ÙƒÙ„ÙŠ: <b id="prayerPct">0%</b></div>
      </div>

      <div class="meterBox">
        <div class="levelTag">
          <div>Ù…Ø±ØªÙØ¹</div>
          <div class="levelPill" id="levelPill">Ù…ØªÙˆØ³Ø·</div>
        </div>
        <div class="meter">
          <div class="bar" id="prayerBar" style="height:0%"></div>
        </div>
      </div>
    </div>

    <div class="scoreLine">Ù…Ø³Ø§Ù‡Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…: <b id="prayerScoreNum">0</b> / 100</div>
    <div class="hint">Ø§Ø¶ØºØ· Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ù‘Ø§Ø¯ØŒ ÙˆØ§Ø¶ØºØ· Ù…Ø·ÙˆÙ‘Ù„Ù‹Ø§/ÙƒÙÙ„Ùƒ ÙŠÙ…ÙŠÙ† Ù„Ù„ØªÙ†Ù‚ÙŠØµ. ÙŠÙØ­Ø¯ÙÙ‘Ø« Ø§Ù„Ù…Ø¤Ø´Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.</div>

    <div class="grid">
      <!-- ØªØ±ÙØ¹ Ø§Ù„Ù…Ø¤Ø´Ø± -->
      <div class="panel">
        <h3>âœ… Ø£Ù…ÙˆØ± ØªØ±ÙØ¹ Ø§Ù„Ù…Ø¤Ø´Ø±</h3>
        <div class="tasks" id="raiseTasks"></div>
      </div>
      <!-- ØªÙÙ†Ù‚Øµ Ø§Ù„Ù…Ø¤Ø´Ø± -->
      <div class="panel">
        <h3>âŒ Ø£Ù…ÙˆØ± ØªÙÙ†Ù‚Øµ Ø§Ù„Ù…Ø¤Ø´Ø±</h3>
        <div class="tasks" id="lowerTasks"></div>
      </div>
    </div>
  </div>

  <script>
    // â€”â€”â€” Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    const MAX_STEPS = 10;                 // Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù„Ù‚Ø© (Ù„Ø§ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ø¨Ø§Ø´Ø±Ø©)
    const GOOD_GRAD = ['#22c55e','#86efac'];
    const BAD_GRAD  = ['#ef4444','#fca5a5'];

    // â€”â€”â€” ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ù‡Ø§Ù… (Ù†ÙØ³ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ø±ÙˆØ­)
    const RAISE = [
      { id:'jamaah',     title:'Ø§Ù„Ø¬Ù…Ø§Ø¹Ø© Ø¨Ø§Ù„Ù…Ø³Ø¬Ø¯', icon:'ğŸ•Œ',   weight:10 },
      { id:'takbira',    title:'ØªÙƒØ¨ÙŠØ±Ø© Ø§Ù„Ø¥Ø­Ø±Ø§Ù…',  icon:'ğŸ',   weight:8  },
      { id:'fajrJam',    title:'Ø§Ù„ÙØ¬Ø± Ø¬Ù…Ø§Ø¹Ø©',     icon:'ğŸŒ…',   weight:10 },
      { id:'sunans',     title:'Ø§Ù„Ø³Ù†Ù† Ø§Ù„Ø±ÙˆØ§ØªØ¨',   icon:'ğŸ§â€â™‚ï¸', weight:6  }
    ];
    const LOWER = [
      { id:'oversleep',  title:'Ø§Ù„Ù†ÙˆÙ… Ø¹Ù† Ø§Ù„ØµÙ„Ø§Ø©', icon:'ğŸ˜´',  weight:10 },
      { id:'lateHabit',  title:'Ø§Ù„ØªØ£Ø®ÙŠØ± Ø§Ù„Ù…Ø¹ØªØ§Ø¯', icon:'â°',  weight:8  },
      { id:'phoneAdhan', title:'Ø§Ù†Ø´ØºØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø£Ø°Ø§Ù†',icon:'ğŸ“±',  weight:6  },
      { id:'skipJamaah', title:'ØªØ±Ùƒ Ø§Ù„Ø¬Ù…Ø§Ø¹Ø©',     icon:'â›”ï¸',  weight:10 }
    ];

    // â€”â€”â€” Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø¯Ù‘Ø§Ø¯Ø§Øª
    const state = {};
    [...RAISE, ...LOWER].forEach(t => state[t.id] = 0);

    // â€”â€”â€” Ø£Ø¯ÙˆØ§Øª Ø±Ø³Ù… Ø§Ù„Ø­Ù„Ù‚Ø© Ø§Ù„Ø³Ù…ÙŠÙƒØ©
    function makeTaskCard(task, type){ // type: 'good'|'bad'
      const size=140, r0=36, cx=size/2, cy=size/2, C=2*Math.PI*r0;
      const gradId = `grad_${type}_${task.id}`;
      const [c1,c2] = (type==='good')?GOOD_GRAD:BAD_GRAD;

      const card = document.createElement('div');
      card.className = 'task';
      card.id = `task_${task.id}`;

      const ring = document.createElement('div');
      ring.className = 'ringwrap';
      ring.innerHTML = `
        <svg class="svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
          <defs>
            <linearGradient id="${gradId}" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%"  stop-color="${c1}"/><stop offset="100%" stop-color="${c2}"/>
            </linearGradient>
          </defs>
          <circle class="track" cx="${cx}" cy="${cy}" r="${r0}"></circle>
          <circle class="prog ${type==='bad'?'badFx':''}" id="prog_${task.id}"
                  cx="${cx}" cy="${cy}" r="${r0}" stroke="url(#${gradId})"
                  stroke-dasharray="${C} ${C}" stroke-dashoffset="${C}"></circle>
        </svg>
      `;

      const inner = document.createElement('div');
      inner.className = 'inner';
      inner.innerHTML = `<div class="icon">${task.icon}</div><div class="title">${task.title}</div>`;

      const count = document.createElement('div');
      count.className = 'count' + (type==='bad'?' bad':'');
      count.id = `count_${task.id}`;
      count.textContent = '0Ã—';

      ring.appendChild(inner);
      ring.appendChild(count);
      card.appendChild(ring);

      // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø²ÙŠØ§Ø¯Ø©/Ø§Ù„Ù†Ù‚Øµ
      const inc = () => { state[task.id]++; updateTask(task.id, type); updateScore(); };
      const dec = () => { state[task.id] = Math.max(0, state[task.id]-1); updateTask(task.id, type); updateScore(); };
      card.addEventListener('click', inc);
      card.addEventListener('contextmenu', e => { e.preventDefault(); dec(); });
      // Ø¶ØºØ·Ø© Ù…Ø·ÙˆÙ‘Ù„Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
      let pressTimer=null;
      card.addEventListener('touchstart', ()=>{ pressTimer=setTimeout(dec, 550); }, {passive:true});
      card.addEventListener('touchend', ()=>{ clearTimeout(pressTimer); });

      return card;
    }

    function updateTask(id, type){
      const steps = Math.min(MAX_STEPS, state[id]);
      const size=140, r0=36, C=2*Math.PI*r0;
      const pct  = steps/MAX_STEPS;             // 0..1 Ù„Ù„Ø­Ù„Ù‚Ø© ÙÙ‚Ø·
      const offset = C*(1-pct);
      document.getElementById(`prog_${id}`).style.strokeDashoffset = offset;
      document.getElementById(`count_${id}`).textContent = state[id] + 'Ã—';
    }

    function renderTasks(){
      const g = document.getElementById('raiseTasks');
      const b = document.getElementById('lowerTasks');
      RAISE.forEach(t => g.appendChild(makeTaskCard(t,'good')));
      LOWER.forEach(t => b.appendChild(makeTaskCard(t,'bad')));
    }

    // â€”â€”â€” Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ø§Ù… (0..100)
    function calcScore(){
      // Ù…Ø¬Ù…ÙˆØ¹ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ â€“ Ù…Ø¬Ù…ÙˆØ¹ Ø³Ù„Ø¨ÙŠ (Ù…Ù‚ÙŠØ¯ Ø¨ÙŠÙ† 0 Ùˆ 100)
      const pos = RAISE.reduce((s,t)=> s + state[t.id]*t.weight, 0);
      const neg = LOWER.reduce((s,t)=> s + state[t.id]*t.weight, 0);
      const raw = pos - neg;               // ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø³Ø§Ù„Ø¨
      const norm = Math.max(0, Math.min(100, raw)); // Ù†Ù‚ÙŠØ¯Ù‡ 0..100
      return {pos,neg,score:norm};
    }

    function updateScore(){
      const {pos,neg,score} = calcScore();
      // Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø£Ø³ÙŠ
      document.getElementById('prayerBar').style.height = score + '%';
      // Ø£Ø±Ù‚Ø§Ù…
      document.getElementById('prayerScoreNum').textContent = Math.round(score);
      document.getElementById('prayerPct').textContent      = Math.round(score) + '%';
      // Ù…Ø³ØªÙˆÙ‰ Ù†ØµÙŠ
      const pill = document.getElementById('levelPill');
      const lvlTxt = document.getElementById('prayerLevelText');
      let label='Ù…ØªÙˆØ³Ø·';
      if(score < 34) label='Ù…Ù†Ø®ÙØ¶';
      else if(score >= 67) label='Ù…Ø±ØªÙØ¹';
      else label='Ù…ØªÙˆØ³Ø·';
      pill.textContent = label;
      lvlTxt.textContent = label;
    }

    // ØªØ´ØºÙŠÙ„
    renderTasks();
    updateScore();
  </script>
</section>
<!-- ======= Ù†Ù‡Ø§ÙŠØ© Ù…ÙƒÙˆÙ‘Ù† Ù…Ø¤Ø´Ø± Ø§Ù„ØµÙ„Ø§Ø© ======= -->

  
  <!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø¨Ø± -->
  <div class="grave-meter-box">
    <h2>ğŸ“‰ Ø¹Ø¯Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±</h2>
    <div class="progress-container"><div id="graveProgress" class="progress-bar"></div></div>
    <p id="graveLevel">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ø¢Ù…Ù†</p>
  </div>

  <!-- Ø§Ù„ØªØ®ÙÙŠÙ -->
  <div class="mitigation-box">
    <h2>ğŸ›¡ï¸ Ø§Ù„ØªØ®ÙÙŠÙ Ù…Ù† Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±</h2>
    <div class="miti-buttons">
      <button onclick="applyMitigation('tawba')">ØªÙˆØ¨Ø© Ù†ØµÙˆØ­</button>
      <button onclick="applyMitigation('surahMulk')">Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ Ù„ÙŠÙ„Ø§Ù‹</button>
      <button onclick="applyMitigation('repayDebt')">Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ†/Ø±Ø¯ Ù…Ø¸Ù„Ù…Ø©</button>
      <button onclick="applyMitigation('cutNamimah')">Ù‚Ø·Ø¹ Ø§Ù„Ù†Ù…ÙŠÙ…Ø©</button>
    </div>
    <div id="mitigationNote" class="miti-note">ÙƒÙ„ Ø®ÙŠØ§Ø± Ù…ØªØ§Ø­ Ù…Ø±Ø© ÙƒÙ„ 24 Ø³Ø§Ø¹Ø©.</div>
  </div>

  <!-- ğŸ•Šï¸ ÙƒØ±Ø§Ù…Ø§Øª ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø© -->
  <div class="day-honors" id="honorsBox">
    <h2>ğŸ•Šï¸ ÙƒØ±Ø§Ù…Ø§Øª ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©</h2>
    <p style="color:#555;margin:6px 0 16px">ØªÙ…Ø«ÙŠÙ„ Ø±Ù…Ø²ÙŠ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ (Ù„Ù„ØªØ°ÙƒÙŠØ± ÙˆØ§Ù„ØªØ­ÙÙŠØ²).</p>
    <div class="honors-grid" id="honorsGrid"></div>
  </div>

  <!-- â— Ø¥Ù‡Ø§Ù†Ø§Øª ÙˆØ¹Ù‚ÙˆØ¨Ø§Øª ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø© -->
  <div class="day-warnings" id="warningsBox">
    <h2>â— Ø¥Ù‡Ø§Ù†Ø§Øª ÙˆØ¹Ù‚ÙˆØ¨Ø§Øª ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©</h2>
    <p style="color:#555;margin:6px 0 16px">Ù…Ø¤Ø´Ø±Ø§Øª ØªØ­Ø°ÙŠØ±ÙŠØ© Ø±Ù…Ø²ÙŠØ© ØªÙ‚Ù„Ù‘ Ø¨Ø§Ù„ØªÙˆØ¨Ø© ÙˆØªØ±Ùƒ Ø£Ø³Ø¨Ø§Ø¨Ù‡Ø§.</p>
    <div class="warnings-grid" id="warningsGrid"></div>
  </div>

  <!-- ğŸŒ Ù…Ø´Ø§Ù‡Ø¯ ÙˆØ£Ø­Ø¯Ø§Ø« Ø¹Ø§Ù…Ø© ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø© -->
  <div class="day-scenes" id="scenesBox">
    <h2>ğŸŒ Ù…Ø´Ø§Ù‡Ø¯ ÙˆØ£Ø­Ø¯Ø§Ø« Ø¹Ø§Ù…Ø© ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©</h2>
    <p style="color:#555;margin:6px 0 16px">Ø¹Ø±Ø¶ ØªÙˆØ¹ÙˆÙŠ Ù„Ø£Ø­ÙˆØ§Ù„ Ø¹Ø§Ù…Ø© (Ù…Ø«Ù„ Ø§Ù„Ø¹Ø±Ù‚ Ø¹Ù„Ù‰ Ù‚Ø¯Ø± Ø§Ù„Ø£Ø¹Ù…Ø§Ù„).</p>
    <div class="scenes-grid" id="scenesGrid"></div>
  </div>

  <!-- ğŸ“– Ù‚Ø³Ù… Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø³ÙˆØ±Ø© Ø£Ùˆ ØµÙØ­Ø§Øª) -->
  <div class="quran-box" id="quranBox">
    <h2 class="q-head">ğŸ“– Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† â€“ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø±ÙˆÙ ÙˆØ§Ù„Ø­Ø³Ù†Ø§Øª</h2>
    <div class="q-controls">
      <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„:
        <select id="qMode" onchange="updateQuranMode()">
          <option value="surah">Ø¨Ø§Ù„Ø³ÙˆØ±Ø©</option>
          <option value="pages">Ø¨Ø§Ù„ØµÙØ­Ø§Øª</option>
        </select>
      </label>

      <span id="modeSurah">
        <select id="surahSelect"></select>
        Ù…Ø±Ø§Øª Ø§Ù„ØªÙ„Ø§ÙˆØ©
        <input id="surahTimes" type="number" min="1" value="1" title="Ù…Ø±Ø§Øª Ø§Ù„ØªÙ„Ø§ÙˆØ©" />
      </span>

      <span id="modePages" style="display:none">
        Ù…Ù† ØµÙØ­Ø© <input id="pageStart" type="number" min="1" max="604" value="1" />
        Ø¥Ù„Ù‰ ØµÙØ­Ø© <input id="pageEnd" type="number" min="1" max="604" value="1" />
        (â‰ˆ 450 Ø­Ø±Ù/ØµÙØ­Ø©)
      </span>
    </div>

    <div class="q-stats">
      Ø§Ù„Ø­Ø±ÙˆÙ: <b id="qLetters">0</b> â€¢ Ø§Ù„Ø­Ø³Ù†Ø§Øª: <b id="qHasanat">0</b>
    </div>

    <div class="q-progress">
      <div id="qBar" class="q-bar"></div>
    </div>
    <div class="q-stats">
      Ø§Ù„ØªÙ‚Ø¯ÙÙ‘Ù…: <b id="qProgressText">0</b> Ù…Ù† <b>3,226,040</b> Ø­Ø³Ù†Ø©
    </div>

    <div class="q-actions">
      <button onclick="addQuranHasanat()">Ø£Ø¶Ù Ù„Ù„Ø­Ø³Ù†Ø§Øª</button>
    </div>
  </div>

  <!-- Ø¥Ù†ÙÙˆØ¬Ø±Ø§ÙÙŠÙƒ: Ø§Ù„Ø¬Ù†Ø© ÙˆØ§Ù„Ù†Ø§Ø± -->
  <div class="infobox">
    <h2>ğŸ§­ Ø£Ø³Ø¨Ø§Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ù†Ø© ÙˆØ§Ù„Ù†Ø§Ø±</h2>
    <div class="two-cols">
      <div class="infosec sec-good">
        <h3>ğŸŒ´ Ø£Ø³Ø¨Ø§Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¬Ù†Ø©</h3>
        <div class="infogrid" id="reasonsGoodGrid"></div>
      </div>
      <div class="infosec sec-bad">
        <h3>ğŸ”¥ Ø£Ø³Ø¨Ø§Ø¨ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø§Ø±</h3>
        <div class="infogrid" id="reasonsBadGrid"></div>
      </div>
    </div>
  </div>

  <!-- Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
  <div class="final-judgment-box">
    <h2>ğŸŒŒ Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h2>
    <div class="judgment-container">
      <div class="judgment-column"><h3>ğŸŒ´ Ø§Ù„Ø¬Ù†Ø©</h3></div>
      <div class="judgment-meter"><div id="judgmentIndicator"></div></div>
      <div class="judgment-column"><h3>ğŸ”¥ Ø§Ù„Ù†Ø§Ø±</h3></div>
    </div>
    <p id="judgmentResult">â¬…ï¸ ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØµÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø£Ø¹Ù…Ø§Ù„Ùƒ...</p>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø±Ø­ -->
  <div class="modal" id="modal"><div class="card">
    <header id="modalTitle">Ø´Ø±Ø­</header>
    <div class="content" id="modalBody"></div>
    <footer><button onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button></footer>
  </div></div>

<script>
  /* =============== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ø¹Ø§Ù…Ø© =============== */
  let goodTotal=0, badTotal=0;
  const K_GOOD=0.6;
  const MITIGATION_POINTS={tawba:25,surahMulk:10,repayDebt:35,cutNamimah:20};
  let mitigationTotal=0;

  function addEntry(type){
    const desc=document.getElementById(`${type}Desc`).value.trim();
    const points=parseInt(document.getElementById(`${type}Points`).value);
    if(!desc||isNaN(points))return;
    const list=document.getElementById(`${type}List`);
    const li=document.createElement('li');
    li.textContent=`${desc} (${points} Ù†Ù‚Ø·Ø©)`;
    li.onclick=()=>{list.removeChild(li); if(type==='good'){goodTotal-=points;} else {badTotal-=points;} refreshUI();};
    list.appendChild(li);
    if(type==='good'){goodTotal+=points;} else {badTotal+=points;}
    document.getElementById('goodTotal').textContent=goodTotal;
    document.getElementById('badTotal').textContent=badTotal;
    document.getElementById(`${type}Desc`).value=''; document.getElementById(`${type}Points`).value='';
    refreshUI();
  }

  function updateNetResult(){document.getElementById('netResult').textContent=goodTotal-badTotal;}

  function showReminder(){
    const reminders=["ÙƒØ§Ù† Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù† Ø¥Ø°Ø§ Ø°ÙÙƒØ± Ø§Ù„Ù‚Ø¨Ø± Ø¨ÙƒÙ‰ Ø­ØªÙ‰ ØªØ¨ØªÙ„ Ù„Ø­ÙŠØªÙ‡.","Ø§Ù„Ù‚Ø¨Ø± Ø£ÙˆÙ„ Ù…Ù†Ø§Ø²Ù„ Ø§Ù„Ø¢Ø®Ø±Ø©ØŒ ÙØ¥Ù† Ù†Ø¬Ø§ Ù…Ù†Ù‡ ÙÙ…Ø§ Ø¨Ø¹Ø¯Ù‡ Ø£ÙŠØ³Ø±.","Ø£ÙƒØ«Ø±ÙˆØ§ Ù…Ù† Ø°ÙƒØ± Ù‡Ø§Ø¯Ù… Ø§Ù„Ù„Ø°Ø§Øª: Ø§Ù„Ù…ÙˆØª.","Ø§Ù„Ù„Ù‡Ù… Ù‚ÙÙ†Ø§ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±ØŒ ÙˆØ«Ø¨Ù‘ØªÙ†Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„.","Ø§Ø³ØªØ¹Ø¯ÙˆØ§ Ù„Ù„Ù‚Ø¨Ø±ØŒ ÙØ¥Ù† Ø§Ù„Ù„ÙŠÙ„ ÙˆØ§Ù„Ù†Ù‡Ø§Ø± ÙŠØ¹Ù…Ù„Ø§Ù† ÙÙŠÙƒÙ…."];
    document.getElementById('reminderText').textContent=reminders[Math.floor(Math.random()*reminders.length)];
  }

  function canUseMitigation(k){const t=localStorage.getItem('miti_'+k); if(!t) return true; return ((Date.now()-parseInt(t,10))/(1000*60*60))>=24;}
  function markMitigationUsed(k){localStorage.setItem('miti_'+k,Date.now().toString());}
  function applyMitigation(k){
    const note=document.getElementById('mitigationNote');
    if(!MITIGATION_POINTS[k])return;
    if(!canUseMitigation(k)){note.textContent="â³ Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ø³ØªÙØ®Ø¯Ù… Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± 24 Ø³Ø§Ø¹Ø©.";return;}
    mitigationTotal+=MITIGATION_POINTS[k]; markMitigationUsed(k);
    note.textContent="âœ… ØªÙ… Ø§Ù„ØªØ®ÙÙŠÙ. Ø§Ø«Ø¨Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø©."; refreshUI();
  }

  function computeGraveRisk(){
    let risk=badTotal - K_GOOD*goodTotal - mitigationTotal;
    if(risk<0)risk=0; if(risk>100)risk=100; return Math.round(risk);
  }
  function updateGraveMeter(){
    const risk=computeGraveRisk();
    document.getElementById('graveProgress').style.width=risk+'%';
    let label="Ø¢Ù…Ù†";
    if(risk>10&&risk<=30)label="ØªØ­Ø°ÙŠØ± Ø¨Ø³ÙŠØ·";
    else if(risk>30&&risk<=60)label="Ø®Ø·Ø± Ù…ØªÙˆØ³Ø· âš ï¸";
    else if(risk>60&&risk<90)label="Ø§Ù‚ØªØ±Ø§Ø¨ Ù…Ù† Ø§Ù„Ø¹Ø°Ø§Ø¨ ğŸ˜Ÿ";
    else if(risk>=90)label="ğŸ”¥ Ø´Ø¯ÙŠØ¯ Ø§Ù„Ø®Ø·Ø± â€“ ØªØ¨ Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†";
    document.getElementById('graveLevel').textContent='Ø§Ù„Ù…Ø³ØªÙˆÙ‰: '+label;
  }
  function autoUpdateFinalJudgment(){
    const net=goodTotal-badTotal;
    let h=50, txt="âš–ï¸ ØªØ¹Ø§Ø¯Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†.";
    if(net>100){h=100;txt="ğŸ¥‡ Ø£Ø¹Ù…Ø§Ù„Ùƒ Ø¹Ø¸ÙŠÙ…Ø©ØŒ ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø¬Ù†Ø© Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡!";}
    else if(net>50){h=80;txt="ğŸŒ¿ Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ø¬Ù†Ø© Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø«Ø¨Ø§Øª.";}
    else if(net>0){h=65;txt="ğŸ¤² Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­.";}
    else if(net===0){h=50;txt="âš–ï¸ ØªØ¹Ø§Ø¯Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†.";}
    else if(net>-30){h=35;txt="â— Ø®Ø·Ø±! Ø±Ø§Ø¬Ø¹ Ù†ÙØ³Ùƒ Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†.";}
    else if(net>-70){h=20;txt="ğŸ”¥ ØªØ³Ø§Ø±Ø¹ Ù†Ø­Ùˆ Ø§Ù„Ø®Ø·Ø±ØŒ Ø¨Ø§Ø¯Ø± Ø¨Ø§Ù„ØªÙˆØ¨Ø©.";}
    else {h=5;txt="ğŸš« Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ù†Ø§Ø± Ø¥Ù† Ù„Ù… ØªØªØ¨ØŒ Ø§Ù„Ù„Ù‡Ù… Ø³Ù„Ù…!";}
    document.getElementById('judgmentIndicator').style.height=h+'%';
    document.getElementById('judgmentResult').textContent=txt;
  }

  /* =============== Ø¥Ù†ÙÙˆØ¬Ø±Ø§ÙÙŠÙƒ Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ (SVG 30 + Ù„Ù…Ø¹Ø©) =============== */
  const MAX_CLICKS=20;
  const REASONS_GOOD=[
    {id:'iman',icon:'ğŸ•‹',label:'Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†',points:25},
    {id:'salah',icon:'ğŸ•Œ',label:'Ø§Ù„ØµÙ„Ø§Ø©',points:20},
    {id:'birr',icon:'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦',label:'Ø¨Ø±Ù‘ Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†',points:18},
    {id:'sadaqa',icon:'ğŸ¤',label:'Ø§Ù„ØµØ¯Ù‚Ø©',points:15},
    {id:'siyam',icon:'ğŸŒ™',label:'Ø§Ù„ØµÙˆÙ…',points:12},
    {id:'silah',icon:'ğŸ§¬',label:'ØµÙ„Ø© Ø§Ù„Ø±Ø­Ù…',points:12}
  ];
  const REASONS_BAD=[
    {id:'kufr',icon:'ğŸš«',label:'Ø§Ù„ÙƒÙØ±/Ø§Ù„Ø´Ø±Ùƒ',points:40},
    {id:'tarkSalah',icon:'â›”ï¸',label:'ØªØ±Ùƒ Ø§Ù„ØµÙ„Ø§Ø©',points:30},
    {id:'uquq',icon:'ğŸ’¢',label:'Ø¹Ù‚ÙˆÙ‚ Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†',points:25},
    {id:'zina',icon:'âš ï¸',label:'Ø§Ù„Ø²Ù†Ø§',points:35},
    {id:'riba',icon:'ğŸ’¸',label:'Ø§Ù„Ø±Ø¨Ø§',points:25},
    {id:'namimahR',icon:'ğŸ—£ï¸',label:'Ø§Ù„Ù†Ù…ÙŠÙ…Ø©',points:15}
  ];
  const clicks={};
  function gradientStops(type){
    if(type==='bad')   return ['#dc3545','#ff7043'];
    if(type==='info')  return ['#2196f3','#64b5f6'];
    return ['#2e7d32','#66bb6a'];
  }
  function createReasonEl(r,type,grid){
    clicks[r.id]=clicks[r.id]||0;
    const size=140, r0=36, cx=size/2, cy=size/2, C=2*Math.PI*r0;
    const gradId=`grad_${type}_${r.id}`;
    const [c1,c2]=gradientStops(type);
    const wrap=document.createElement('div'); wrap.className='reason '+(type==='bad'?'bad':'good'); wrap.id='reason_'+r.id;
    const ringwrap=document.createElement('div'); ringwrap.className='ringwrap';
    ringwrap.innerHTML=`
      <svg class="svg-r" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
        <defs><linearGradient id="${gradId}" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="${c1}"/><stop offset="100%" stop-color="${c2}"/></linearGradient></defs>
        <circle class="track-r" cx="${cx}" cy="${cy}" r="${r0}"></circle>
        <circle class="${type==='bad'?'prog-bad-r':'prog-good-r'}" id="prog_${r.id}" cx="${cx}" cy="${cy}" r="${r0}"
          stroke="url(#${gradId})" stroke-linecap="round" stroke-dasharray="${C} ${C}" stroke-dashoffset="${C}"></circle>
      </svg>`;
    const inner=document.createElement('div'); inner.className='reason-inner';
    inner.innerHTML=`<div class="icon">${r.icon}</div><div class="title">${r.label}</div><div class="times"><span id="t_${r.id}">0</span>Ã—</div>`;
    const count=document.createElement('div'); count.className='count'; count.textContent='0Ã—';
    ringwrap.appendChild(inner); ringwrap.appendChild(count); wrap.appendChild(ringwrap);

    wrap.onclick=()=>{
      if(clicks[r.id] >= MAX_CLICKS) return;
      clicks[r.id]++; const pct=clicks[r.id]/MAX_CLICKS; const offset=C*(1-pct);
      document.getElementById('prog_'+r.id).style.strokeDashoffset=offset;
      document.getElementById('t_'+r.id).textContent=clicks[r.id]; count.textContent=clicks[r.id]+'Ã—';
      if(type==='good'){ goodTotal+=r.points; } else { badTotal+=r.points; }
      document.getElementById('goodTotal').textContent=goodTotal; document.getElementById('badTotal').textContent=badTotal;
      refreshUI();
    };
    grid.appendChild(wrap);
  }
  function renderReasons(){
    const gGrid=document.getElementById('reasonsGoodGrid');
    const bGrid=document.getElementById('reasonsBadGrid');
    REASONS_GOOD.forEach(r=>createReasonEl(r,'good',gGrid));
    REASONS_BAD.forEach(r=>createReasonEl(r,'bad',bGrid));
  }

  /* =============== Ù‚ÙˆØ§Ø¦Ù… Ø¬Ø§Ù‡Ø²Ø© =============== */
  const goodActions=[{text:"ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± ÙÙŠ ÙˆÙ‚ØªÙ‡Ø§",points:20},{text:"Ø§Ù„ØµØ¯Ù‚Ø© Ø¹Ù„Ù‰ Ù…Ø­ØªØ§Ø¬",points:15},{text:"Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†",points:10},{text:"Ø¨Ø± Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†",points:25},{text:"Ø§Ù„Ø§Ø¨ØªØ³Ø§Ù…Ø© ÙÙŠ ÙˆØ¬Ù‡ Ø£Ø®ÙŠÙƒ",points:5},{text:"Ø§Ù„Ø§Ø³ØªØºÙØ§Ø± 100 Ù…Ø±Ø©",points:12},{text:"Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„",points:18},{text:"Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ï·º 100 Ù…Ø±Ø©",points:12}];
  const badActions=[{text:"Ø§Ù„ÙƒØ°Ø¨",points:10},{text:"Ø§Ù„Ù†Ù…ÙŠÙ…Ø©",points:15},{text:"ØªØ±Ùƒ Ø§Ù„ØµÙ„Ø§Ø©",points:25},{text:"Ø¥ÙŠØ°Ø§Ø¡ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†",points:12},{text:"Ø³Ù…Ø§Ø¹ Ø§Ù„Ø­Ø±Ø§Ù…",points:8},{text:"Ù†Ø¸Ø± Ù…Ø­Ø±Ù…",points:7},{text:"Ø§Ù„ØºÙŠØ¨Ø©",points:15}];

  function populateDropdowns(){
    const goodSelect=document.createElement("select"); goodSelect.id="goodSelect"; goodSelect.innerHTML='<option value="">Ø§Ø®ØªØ± Ø¹Ù…Ù„Ù‹Ø§ Ø­Ø³Ù†Ù‹Ø§</option>';
    goodActions.forEach(a=>{const o=document.createElement("option"); o.value=a.points; o.textContent=`${a.text} (+${a.points})`; goodSelect.appendChild(o);});
    const goodBtn=document.createElement("button"); goodBtn.textContent="Ø¥Ø¶Ø§ÙØ©"; goodBtn.onclick=()=>{const s=goodSelect.options[goodSelect.selectedIndex]; if(s.value){document.getElementById("goodDesc").value=s.textContent; document.getElementById("goodPoints").value=s.value; addEntry('good');}};
    const badSelect=document.createElement("select"); badSelect.id="badSelect"; badSelect.innerHTML='<option value="">Ø§Ø®ØªØ± Ø¹Ù…Ù„Ù‹Ø§ Ø³ÙŠØ¦Ù‹Ø§</option>';
    badActions.forEach(a=>{const o=document.createElement("option"); o.value=a.points; o.textContent=`${a.text} (-${a.points})`; badSelect.appendChild(o);});
    const badBtn=document.createElement("button"); badBtn.textContent="Ø¥Ø¶Ø§ÙØ©"; badBtn.onclick=()=>{const s=badSelect.options[badSelect.selectedIndex]; if(s.value){document.getElementById("badDesc").value=s.textContent; document.getElementById("badPoints").value=s.value; addEntry('bad');}};
    document.getElementById("good").appendChild(goodSelect); document.getElementById("good").appendChild(goodBtn);
    document.getElementById("bad").appendChild(badSelect); document.getElementById("bad").appendChild(badBtn);
  }

  /* =============== ÙƒØ±Ø§Ù…Ø§Øª / ØªØ­Ø°ÙŠØ±Ø§Øª / Ù…Ø´Ø§Ù‡Ø¯ =============== */
  const Honors=[
    { id:'shadeThrone', icon:'ğŸŒ¤ï¸', title:'Ø§Ù„Ø¸Ù„ ØªØ­Øª Ø§Ù„Ø¹Ø±Ø´', explain:'Ø³Ø¨Ø¹Ø© ÙŠØ¸Ù„Ù‡Ù… Ø§Ù„Ù„Ù‡ ÙÙŠ Ø¸Ù„Ù‡â€¦ Ù…Ø¤Ø´Ø± Ø±Ù…Ø²ÙŠ ÙŠØªØ¯Ø±Ø¬ Ø¨ØªØ­Ù‚Ù‚ Ù…Ø¹Ø§Ù†ÙŠÙ‡Ø§.', compute: ()=> Math.min(1, (goodTotal>badTotal?0.6:0.2) + (goodTotal/200)) },
    { id:'charityShade', icon:'ğŸ•¯ï¸', title:'Ø§Ù„Ù…Ø±Ø¡ ÙÙŠ Ø¸Ù„ ØµØ¯Ù‚ØªÙ‡', explain:'ÙŠØªÙ‚ÙˆÙ‰ Ø§Ù„Ø¸Ù„ Ø¨Ù‚Ø¯Ø± Ø§Ù„ØµØ¯Ù‚Ø©.', compute: ()=> Math.min(1, (goodTotal/300)) },
    { id:'crownQuran', icon:'ğŸ‘‘', title:'ØªØ§Ø¬ Ø§Ù„ÙˆÙ‚Ø§Ø±', explain:'Ù„Ù„Ø£Ø¨ÙˆÙŠÙ† Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù‚Ø±Ø¢Ù†Ø› Ù…Ø¤Ø´Ø± Ø±Ù…Ø²ÙŠ Ù…Ø¹ Ù…Ù‚Ø¯Ø§Ø± Ø§Ù„ØªÙ„Ø§ÙˆØ©.', compute: ()=> Math.min(1, (quranHasanat/50000)) },
    { id:'shafaa', icon:'ğŸ¤²', title:'Ø§Ù„Ø´ÙØ§Ø¹Ø©', explain:'ØªØ±Ø¬Ù‰ Ù„Ø£Ù‡Ù„ Ø§Ù„ØªÙˆØ­ÙŠØ¯ ÙˆØ§Ù„Ø¥Ø®Ù„Ø§ØµØ› Ù…Ø¤Ø´Ø± Ø±Ù…Ø²ÙŠ Ø¨Ø§Ù„Ø¥ÙŠÙ…Ø§Ù† ÙˆØµØ§ÙÙŠ Ø§Ù„Ù…ÙŠØ²Ø§Ù†.', compute: ()=> Math.min(1, (Math.max(0,goodTotal-badTotal)/150)) },
    { id:'hawd', icon:'ğŸï¸', title:'Ø§Ù„Ø­ÙˆØ¶ ÙˆØ§Ù„ÙƒÙˆØ«Ø±', explain:'ÙŠÙ‚ÙˆÙ‰ Ø¨Ø§Ù„Ø§ØªØ¨Ø§Ø¹ ÙˆØ§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ï·º (ØªÙ…Ø«ÙŠÙ„ÙŠ).', compute: ()=> Math.min(1, goodTotal/250) },
    { id:'siratLight', icon:'ğŸ’¡', title:'Ù†ÙˆØ± Ø§Ù„ØµØ±Ø§Ø·', explain:'Ø§Ù„Ø¥ÙŠÙ…Ø§Ù† ÙˆØ§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­ ÙŠÙˆØ±Ø«Ø§Ù† Ù†ÙˆØ±Ù‹Ø§ (ØªÙ…Ø«ÙŠÙ„ÙŠ).', compute: ()=> Math.min(1, goodTotal/(goodTotal+badTotal+1)) }
  ];
  const Warnings=[
    { id:'bookLeft', icon:'ğŸ“„', title:'Ø£Ø®Ø° Ø§Ù„ÙƒØªØ§Ø¨ Ø¨Ø§Ù„Ø´Ù…Ø§Ù„', explain:'ØªØ­Ø°ÙŠØ± Ø±Ù…Ø²ÙŠ ÙŠØ±ØªÙØ¹ Ù…Ø¹ ØµØ§ÙÙŠ Ø§Ù„Ø³ÙŠØ¦Ø§Øª.', compute: ()=> Math.max(0, Math.min(1, (badTotal - goodTotal)/120 )) },
    { id:'deniedShade', icon:'â˜€ï¸', title:'Ø§Ù„Ø­Ø±Ù…Ø§Ù† Ù…Ù† Ø§Ù„Ø¸Ù„', explain:'ÙŠØ±ØªÙØ¹ Ù…Ø¹ Ø§Ù„Ø¸Ù„Ù… ÙˆØ§Ù„Ø°Ù†ÙˆØ¨ Ø§Ù„ÙƒØ¨ÙŠØ±Ø©.', compute: ()=> Math.max(0, Math.min(1, badTotal/150 )) },
    { id:'drivenOnFaces', icon:'â›“ï¸', title:'Ø§Ù„Ø³Ø­Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¬ÙˆÙ‡', explain:'Ø±Ù…Ø²ÙŠ Ù…Ø¹ ØªØ±Ø§ÙƒÙ… Ø§Ù„ÙƒØ¨Ø§Ø¦Ø±.', compute: ()=> Math.max(0, Math.min(1, badTotal/180 )) },
    { id:'deniedHawd', icon:'ğŸš±', title:'Ø§Ù„Ø°ÙÙ‘ÙˆÙ’Ø¯ Ø¹Ù† Ø§Ù„Ø­ÙˆØ¶', explain:'ÙŠÙ†Ø®ÙØ¶ Ø¨Ø§ØªØ¨Ø§Ø¹ Ø§Ù„Ø³Ù†Ø© ÙˆÙƒØ«Ø±Ø© Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ï·º.', compute: ()=> Math.max(0, Math.min(1, 1 - (goodTotal/250) )) },
    { id:'exposed', icon:'ğŸ«¢', title:'Ø§Ù„ÙØ¶ÙŠØ­Ø© Ø£Ù…Ø§Ù… Ø§Ù„Ø®Ù„Ù‚', explain:'ÙŠÙ†Ø®ÙØ¶ Ø¨Ø§Ù„Ø³ØªØ± ÙˆØ§Ù„ØªÙˆØ¨Ø© ÙˆØ±Ø¯ Ø§Ù„Ù…Ø¸Ø§Ù„Ù….', compute: ()=> Math.max(0, Math.min(1, badTotal/200 )) }
  ];
  const Scenes=[
    { id:'sweat', icon:'ğŸ’§', title:'Ø§Ù„Ø¹Ø±Ù‚ Ø¹Ù„Ù‰ Ù‚Ø¯Ø± Ø§Ù„Ø£Ø¹Ù…Ø§Ù„', explain:'ØªØ¯Ù†Ùˆ Ø§Ù„Ø´Ù…Ø³â€¦ ÙÙŠÙƒÙˆÙ† Ø§Ù„Ø¹Ø±Ù‚ Ø¹Ù„Ù‰ Ù‚Ø¯Ø± Ø§Ù„Ø£Ø¹Ù…Ø§Ù„.', compute: ()=> Math.min(1, Math.max(0,badTotal-goodTotal)/120 ) },
    { id:'longStanding', icon:'â³', title:'Ø§Ù„ÙˆÙ‚ÙˆÙ Ø§Ù„Ø·ÙˆÙŠÙ„', explain:'ÙŠÙˆÙ… Ù…Ù‚Ø¯Ø§Ø±Ù‡ Ø®Ù…Ø³ÙˆÙ† Ø£Ù„Ù Ø³Ù†Ø©. Ù…Ø¤Ø´Ø± Ø±Ù…Ø²ÙŠ.', compute: ()=> Math.min(1, (badTotal*0.5 - goodTotal*0.2 + 20)/120 ) },
    { id:'balance', icon:'âš–ï¸', title:'Ø§Ù„Ù…ÙŠØ²Ø§Ù†', explain:'Ø§Ù…ØªÙ„Ø§Ø¤Ù‡ ÙŠØ¹Ù†ÙŠ Ø£Ù…Ø§Ù† Ø£ÙƒØ«Ø±.', compute: ()=> Math.max(0, Math.min(1, goodTotal/(badTotal+goodTotal+1) )) },
    { id:'suhuf', icon:'ğŸ“š', title:'ØªØ·Ø§ÙŠØ± Ø§Ù„ØµØ­Ù', explain:'ÙŠÙ‚ÙˆÙ‰ Ù…Ø¹ ØºÙ„Ø¨Ø© Ø§Ù„Ø­Ø³Ù†Ø§Øª.', compute: ()=> Math.max(0, Math.min(1, (goodTotal-badTotal+50)/150 )) }
  ];

  function createCircleCard(containerId, cfgList, kind){
    const grid=document.getElementById(containerId);
    cfgList.forEach(cfg=>{
      const size=140, r0=36, cx=size/2, cy=size/2, C=2*Math.PI*r0;
      const gradId=`${kind}grad_${cfg.id}`; const [c1,c2]=gradientStops(kind==='warn'?'bad': (kind==='scene'?'info':'good'));
      const card=document.createElement('div'); card.className=(kind==='warn'?'warn-card':(kind==='scene'?'scene-card':'honor-card')); card.id=`${kind}_${cfg.id}`;
      const ringwrap=document.createElement('div'); ringwrap.className='ringwrap';
      ringwrap.innerHTML=`
        <svg class="svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
          <defs><linearGradient id="${gradId}" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="${c1}"/><stop offset="100%" stop-color="${c2}"/></linearGradient></defs>
          <circle class="track" cx="${cx}" cy="${cy}" r="${r0}"></circle>
          <circle class="${kind==='warn'?'prog-bad':(kind==='scene'?'prog-info':'prog-good')}" id="${kind}prog_${cfg.id}" cx="${cx}" cy="${cy}" r="${r0}" stroke="url(#${gradId})" stroke-linecap="round" stroke-dasharray="${C} ${C}" stroke-dashoffset="${C}"></circle>
        </svg>`;
      const inner=document.createElement('div'); inner.className='inner';
      inner.innerHTML=`<div class="icon">${cfg.icon}</div><div class="title">${cfg.title}</div><div class="meta" id="${kind}meta_${cfg.id}">0%</div>`;
      const help=document.createElement('div'); help.className='help'; help.textContent='?'; help.onclick=()=>openModal(cfg.title,cfg.explain);
      const badge=document.createElement('div'); badge.className='count-badge'+(kind==='warn'?' bad':''); badge.textContent='â€”';
      ringwrap.appendChild(inner); ringwrap.appendChild(help); ringwrap.appendChild(badge);
      card.appendChild(ringwrap); grid.appendChild(card);
      card._C=C; card._badge=badge;
    });
  }
  function updateCircleCard(kind,cfg){
    const card=document.getElementById(`${kind}_${cfg.id}`); if(!card) return;
    const C=card._C; const v=Math.max(0,Math.min(1,cfg.compute())); const offset=C*(1-v);
    document.getElementById(`${kind}prog_${cfg.id}`).style.strokeDashoffset=offset;
    document.getElementById(`${kind}meta_${cfg.id}`).textContent=Math.round(v*100)+'%';
  }
  function renderHonors(){ createCircleCard('honorsGrid',Honors,'hon'); updateHonors(); }
  function renderWarnings(){ createCircleCard('warningsGrid',Warnings,'warn'); updateWarnings(); }
  function renderScenes(){ createCircleCard('scenesGrid',Scenes,'scene'); updateScenes(); }
  function updateHonors(){ Honors.forEach(h=>updateCircleCard('hon',h)); }
  function updateWarnings(){ Warnings.forEach(w=>updateCircleCard('warn',w)); }
  function updateScenes(){ Scenes.forEach(s=>updateCircleCard('scene',s)); }

  /* =============== Ù‚Ø³Ù… Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø³ÙˆØ±Ø© Ø£Ùˆ ØµÙØ­Ø§Øª) =============== */
  const TOTAL_QURAN_LETTERS=322604; // Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø­Ø±ÙˆÙ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§ØªÙƒ
  const TOTAL_QURAN_HASANAT=TOTAL_QURAN_LETTERS*10; // 3,226,040
  let quranHasanat=0; // Ø§Ù„Ù…ØªØ±Ø§ÙƒÙ… Ù…Ù† Ø§Ù„Ù‚Ø³Ù…
  const surahData=[
    {n:1,  name:'Ø§Ù„ÙØ§ØªØ­Ø©',     letters:143},
    {n:2,  name:'Ø§Ù„Ø¨Ù‚Ø±Ø©',       letters:26246},
    {n:3,  name:'Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†',     letters:14985},
    {n:4,  name:'Ø§Ù„Ù†Ø³Ø§Ø¡',       letters:16334},
    {n:5,  name:'Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©',      letters:12206},
    {n:6,  name:'Ø§Ù„Ø£Ù†Ø¹Ø§Ù…',      letters:12727},
    {n:7,  name:'Ø§Ù„Ø£Ø¹Ø±Ø§Ù',      letters:14439},
    {n:8,  name:'Ø§Ù„Ø£Ù†ÙØ§Ù„',      letters:5383},
    {n:9,  name:'Ø§Ù„ØªÙˆØ¨Ø©',       letters:11115},
    {n:10, name:'ÙŠÙˆÙ†Ø³',         letters:7589},
    {n:11, name:'Ù‡ÙˆØ¯',          letters:7818},
    {n:12, name:'ÙŠÙˆØ³Ù',         letters:7307},
    {n:13, name:'Ø§Ù„Ø±Ø¹Ø¯',        letters:3545},
    {n:14, name:'Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',      letters:3539},
    {n:15, name:'Ø§Ù„Ø­Ø¬Ø±',        letters:2882},
    {n:16, name:'Ø§Ù„Ù†Ø­Ù„',        letters:7832},
    {n:17, name:'Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡',      letters:6643},
    {n:18, name:'Ø§Ù„ÙƒÙ‡Ù',        letters:6552},
    {n:19, name:'Ù…Ø±ÙŠÙ…',         letters:3935},
    {n:20, name:'Ø·Ù‡',           letters:5399},
    {n:21, name:'Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡',     letters:5094},
    {n:22, name:'Ø§Ù„Ø­Ø¬',         letters:5314},
    {n:23, name:'Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†',     letters:4483},
    {n:24, name:'Ø§Ù„Ù†ÙˆØ±',        letters:5754},
    {n:25, name:'Ø§Ù„ÙØ±Ù‚Ø§Ù†',      letters:3877},
    {n:26, name:'Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡',      letters:5630},
    {n:27, name:'Ø§Ù„Ù†Ù…Ù„',        letters:4792},
    {n:28, name:'Ø§Ù„Ù‚ØµØµ',        letters:5931},
    {n:29, name:'Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª',     letters:4317},
    {n:30, name:'Ø§Ù„Ø±ÙˆÙ…',        letters:3473},
    {n:31, name:'Ù„Ù‚Ù…Ø§Ù†',        letters:2171},
    {n:32, name:'Ø§Ù„Ø³Ø¬Ø¯Ø©',       letters:1563},
    {n:33, name:'Ø§Ù„Ø£Ø­Ø²Ø§Ø¨',      letters:5788},
    {n:34, name:'Ø³Ø¨Ø£',          letters:3594},
    {n:35, name:'ÙØ§Ø·Ø±',         letters:3238},
    {n:36, name:'ÙŠØ³',           letters:3068},
    {n:37, name:'Ø§Ù„ØµØ§ÙØ§Øª',      letters:3899},
    {n:38, name:'Øµ',            letters:3066},
    {n:39, name:'Ø§Ù„Ø²Ù…Ø±',        letters:4869},
    {n:40, name:'ØºØ§ÙØ±',         letters:5108},
    {n:41, name:'ÙØµÙ„Øª',         letters:3364},
    {n:42, name:'Ø§Ù„Ø´ÙˆØ±Ù‰',       letters:3522},
    {n:43, name:'Ø§Ù„Ø²Ø®Ø±Ù',       letters:3610},
    {n:44, name:'Ø§Ù„Ø¯Ø®Ø§Ù†',       letters:1474},
    {n:45, name:'Ø§Ù„Ø¬Ø§Ø«ÙŠØ©',      letters:2085},
    {n:46, name:'Ø§Ù„Ø£Ø­Ù‚Ø§Ù',      letters:2667},
    {n:47, name:'Ù…Ø­Ù…Ø¯',         letters:2423},
    {n:48, name:'Ø§Ù„ÙØªØ­',        letters:2510},
    {n:49, name:'Ø§Ù„Ø­Ø¬Ø±Ø§Øª',      letters:1533},
    {n:50, name:'Ù‚',            letters:1507},
    {n:51, name:'Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª',     letters:1546},
    {n:52, name:'Ø§Ù„Ø·ÙˆØ±',        letters:1324},
    {n:53, name:'Ø§Ù„Ù†Ø¬Ù…',        letters:1433},
    {n:54, name:'Ø§Ù„Ù‚Ù…Ø±',        letters:1469},
    {n:55, name:'Ø§Ù„Ø±Ø­Ù…Ù†',       letters:1648},
    {n:56, name:'Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©',      letters:1756},
    {n:57, name:'Ø§Ù„Ø­Ø¯ÙŠØ¯',       letters:2545},
    {n:58, name:'Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©',     letters:2046},
    {n:59, name:'Ø§Ù„Ø­Ø´Ø±',        letters:1970},
    {n:60, name:'Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©',     letters:1560},
    {n:61, name:'Ø§Ù„ØµÙ',         letters:966},
    {n:62, name:'Ø§Ù„Ø¬Ù…Ø¹Ø©',       letters:768},
    {n:63, name:'Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†',    letters:801},
    {n:64, name:'Ø§Ù„ØªØºØ§Ø¨Ù†',      letters:1091},
    {n:65, name:'Ø§Ù„Ø·Ù„Ø§Ù‚',       letters:1203},
    {n:66, name:'Ø§Ù„ØªØ­Ø±ÙŠÙ…',      letters:1105},
    {n:67, name:'Ø§Ù„Ù…Ù„Ùƒ',        letters:1347},
    {n:68, name:'Ø§Ù„Ù‚Ù„Ù…',        letters:1288},
    {n:69, name:'Ø§Ù„Ø­Ø§Ù‚Ø©',       letters:1133},
    {n:70, name:'Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬',      letters:971},
    {n:71, name:'Ù†ÙˆØ­',          letters:965},
    {n:72, name:'Ø§Ù„Ø¬Ù†',         letters:1109},
    {n:73, name:'Ø§Ù„Ù…Ø²Ù…Ù„',       letters:854},
    {n:74, name:'Ø§Ù„Ù…Ø¯Ø«Ø±',       letters:1035},
    {n:75, name:'Ø§Ù„Ù‚ÙŠØ§Ù…Ø©',      letters:677},
    {n:76, name:'Ø§Ù„Ø¥Ù†Ø³Ø§Ù†',      letters:1087},
    {n:77, name:'Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª',     letters:841},
    {n:78, name:'Ø§Ù„Ù†Ø¨Ø£',        letters:796},
    {n:79, name:'Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª',     letters:785},
    {n:80, name:'Ø¹Ø¨Ø³',          letters:552},
    {n:81, name:'Ø§Ù„ØªÙƒÙˆÙŠØ±',      letters:435},
    {n:82, name:'Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±',     letters:333},
    {n:83, name:'Ø§Ù„Ù…Ø·ÙÙÙŠÙ†',     letters:751},
    {n:84, name:'Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚',     letters:445},
    {n:85, name:'Ø§Ù„Ø¨Ø±ÙˆØ¬',       letters:469},
    {n:86, name:'Ø§Ù„Ø·Ø§Ø±Ù‚',       letters:254},
    {n:87, name:'Ø§Ù„Ø£Ø¹Ù„Ù‰',       letters:296},
    {n:88, name:'Ø§Ù„ØºØ§Ø´ÙŠØ©',      letters:382},
    {n:89, name:'Ø§Ù„ÙØ¬Ø±',        letters:584},
    {n:90, name:'Ø§Ù„Ø¨Ù„Ø¯',        letters:342},
    {n:91, name:'Ø§Ù„Ø´Ù…Ø³',        letters:253},
    {n:92, name:'Ø§Ù„Ù„ÙŠÙ„',        letters:314},
    {n:93, name:'Ø§Ù„Ø¶Ø­Ù‰',        letters:165},
    {n:94, name:'Ø§Ù„Ø´Ø±Ø­',        letters:102},
    {n:95, name:'Ø§Ù„ØªÙŠÙ†',        letters:162},
    {n:96, name:'Ø§Ù„Ø¹Ù„Ù‚',        letters:288},
    {n:97, name:'Ø§Ù„Ù‚Ø¯Ø±',        letters:115},
    {n:98, name:'Ø§Ù„Ø¨ÙŠÙ†Ø©',       letters:404},
    {n:99, name:'Ø§Ù„Ø²Ù„Ø²Ù„Ø©',      letters:158},
    {n:100,name:'Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª',     letters:169},
    {n:101,name:'Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©',      letters:159},
    {n:102,name:'Ø§Ù„ØªÙƒØ§Ø«Ø±',      letters:123},
    {n:103,name:'Ø§Ù„Ø¹ØµØ±',        letters:73},
    {n:104,name:'Ø§Ù„Ù‡Ù…Ø²Ø©',       letters:134},
    {n:105,name:'Ø§Ù„ÙÙŠÙ„',        letters:97},
    {n:106,name:'Ù‚Ø±ÙŠØ´',        letters:77},
    {n:107,name:'Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†',      letters:114},
    {n:108,name:'Ø§Ù„ÙƒÙˆØ«Ø±',       letters:43},
    {n:109,name:'Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†',     letters:99},
    {n:110,name:'Ø§Ù„Ù†ØµØ±',        letters:80},
    {n:111,name:'Ø§Ù„Ù…Ø³Ø¯',        letters:81},
    {n:112,name:'Ø§Ù„Ø¥Ø®Ù„Ø§Øµ',      letters:47},
    {n:113,name:'Ø§Ù„ÙÙ„Ù‚',        letters:73},
    {n:114,name:'Ø§Ù„Ù†Ø§Ø³',        letters:80},
  ];

  function populateSurahSelect(){
    const s=document.getElementById('surahSelect');
    s.innerHTML='';
    surahData.forEach(x=>{
      const o=document.createElement('option');
      o.value=x.n;
      o.textContent=`${x.n}. ${x.name} â€” ${x.letters} Ø­Ø±Ù`;
      s.appendChild(o);
    });
  }

  function updateQuranMode(){
    const mode=document.getElementById('qMode').value;
    document.getElementById('modeSurah').style.display=(mode==='surah')?'inline-flex':'none';
    document.getElementById('modePages').style.display=(mode==='pages')?'inline-flex':'none';
    recalcQuranPreview();
  }

  function recalcQuranPreview(){
    const mode=document.getElementById('qMode').value;
    let letters=0;
    if(mode==='surah'){
      const n=parseInt(document.getElementById('surahSelect').value||'1',10);
      const times=Math.max(1, parseInt(document.getElementById('surahTimes').value||'1',10));
      const s=surahData.find(x=>x.n===n);
      letters = (s?s.letters:0)*times;
    }else{
      const a=Math.min(604, Math.max(1, parseInt(document.getElementById('pageStart').value||'1',10)));
      const b=Math.min(604, Math.max(1, parseInt(document.getElementById('pageEnd').value||'1',10)));
      const pages = Math.max(0, (Math.max(a,b)-Math.min(a,b)+1));
      letters = pages*450; // Ø­Ø³Ø¨ Ø·Ù„Ø¨Ùƒ
    }
    const hasanat = letters*10;
    document.getElementById('qLetters').textContent=letters.toLocaleString('ar-EG');
    document.getElementById('qHasanat').textContent=hasanat.toLocaleString('ar-EG');

    // ØªÙ‚Ø¯ÙÙ‘Ù… Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ Ù„ÙƒÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†
    const prog = Math.min(100, (hasanat/TOTAL_QURAN_HASANAT)*100);
    document.getElementById('qBar').style.width = prog + '%';
    document.getElementById('qProgressText').textContent = hasanat.toLocaleString('ar-EG');
  }

  function addQuranHasanat(){
    const hasanat = parseInt((document.getElementById('qHasanat').textContent||'0').replace(/\D/g,''),10) || 0;
    if(!hasanat) return;
    quranHasanat += hasanat;           // Ù„ØªØªØ¨Ø¹ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚Ø±Ø¢Ù† ÙÙŠ Ø§Ù„ÙƒØ±Ø§Ù…Ø§Øª
    goodTotal += hasanat;              // ØªÙØ¶Ø§Ù Ù„Ù„Ø­Ø³Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
    document.getElementById('goodTotal').textContent=goodTotal.toLocaleString('ar-EG');
    refreshUI();
  }

  /* =============== ØªØ­Ø¯ÙŠØ« Ø´Ø§Ù…Ù„ =============== */
  function refreshUI(){
    updateNetResult(); updateGraveMeter(); autoUpdateFinalJudgment();
    updateHonors(); updateWarnings(); updateScenes();
  }

  /* =============== Ù†Ø§ÙØ°Ø© Ø§Ù„Ø´Ø±Ø­ =============== */
  function openModal(title, body){
    document.getElementById('modalTitle').textContent=title;
    document.getElementById('modalBody').textContent=body;
    document.getElementById('modal').classList.add('active');
  }
  function closeModal(){ document.getElementById('modal').classList.remove('active'); }

  /* =============== ØªØ´ØºÙŠÙ„ =============== */
  window.onload=()=>{
    populateDropdowns();
    // Ø¯ÙˆØ§Ø¦Ø± Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨
    (function renderReasons(){
      const gGrid=document.getElementById('reasonsGoodGrid');
      const bGrid=document.getElementById('reasonsBadGrid');
      REASONS_GOOD.forEach(r=>createReasonEl(r,'good',gGrid));
      REASONS_BAD.forEach(r=>createReasonEl(r,'bad',bGrid));
    })();
    // ÙƒØ±Ø§Ù…Ø§Øª/ØªØ­Ø°ÙŠØ±Ø§Øª/Ù…Ø´Ø§Ù‡Ø¯
    renderHonors(); renderWarnings(); renderScenes();
    // Ø§Ù„Ù‚Ø±Ø¢Ù†
    populateSurahSelect();
    document.getElementById('surahSelect').addEventListener('change',recalcQuranPreview);
    document.getElementById('surahTimes').addEventListener('input',recalcQuranPreview);
    ['pageStart','pageEnd'].forEach(id=>document.getElementById(id).addEventListener('input',recalcQuranPreview));
    updateQuranMode();
    recalcQuranPreview();
    refreshUI();
  };
</script>
</body>
</html>
