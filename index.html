<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body {
      font-family: Tahoma, Arial, sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 20px;
      text-align: center;
      line-height: 1.6;
    }
    h1 { color: #2e7d32; margin: 0 0 10px; }
    .container {
      display: flex; justify-content: center; gap: 40px; margin-top: 20px; flex-wrap: wrap;
    }
    .column {
      background-color: #fff; padding: 16px; width: 320px; border-radius: 10px; box-shadow: 0 0 10px #ccc;
    }
    .column h2 { margin-top: 0; }
    input, button, select {
      padding: 8px; margin: 5px; width: 90%; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;
    }
    ul { list-style-type: none; padding: 0; margin: 12px 0; text-align: right; }
    li {
      margin-bottom: 6px; background-color: #e0f2f1; padding: 8px; border-radius: 6px; cursor: pointer;
    }
    .helper { font-size: 12px; color: #666; margin-top: -4px; }
    .summary { margin-top: 16px; font-size: 1.1em; color: #333; }

    /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªØ°ÙƒÙŠØ± */
    .reminder-box {
      background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;
      padding: 16px; margin: 24px auto 12px; width: 92%; max-width: 800px;
      border-radius: 10px; box-shadow: 0 0 10px #ccc; text-align: right;
    }
    .reminder-box button {
      background-color: #ffc107; border: none; padding: 8px 14px; font-size: 0.95em; border-radius: 6px; cursor: pointer;
    }

    /* Ø¹Ø¯Ù‘Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± */
    .grave-meter-box {
      background-color: #fdecea; color: #611a15; border: 1px solid #f5c6cb;
      padding: 16px; margin: 16px auto; width: 92%; max-width: 800px;
      border-radius: 10px; box-shadow: 0 0 10px #ccc; text-align: right;
    }
    .progress-container {
      background-color: #f8d7da; border-radius: 20px; overflow: hidden; height: 25px; margin: 10px 0;
    }
    .progress-bar {
      height: 100%; width: 0%; background-color: #dc3545; transition: width 0.5s ease-in-out;
    }

    /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªØ®ÙÙŠÙ */
    .risk-mitigation-box{
      background:#eef7ff;border:1px solid #cfe8ff;color:#053b74;
      padding:16px;margin:16px auto;width:92%;max-width:800px;
      border-radius:10px;box-shadow:0 0 10px #ccc; text-align: right;
    }
    .mitigation-grid{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-start;margin-top:8px}
    .mitigation-grid button{
      border:none;padding:10px 14px;border-radius:8px;cursor:pointer;background:#1976d2;color:#fff;font-size:14px;
    }

    /* Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ + Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø±Ø£Ø³ÙŠ */
    .final-judgment-box {
      background-color: #e8f5e9; color: #1b5e20; border: 1px solid #c8e6c9;
      padding: 16px; margin: 16px auto; width: 92%; max-width: 800px;
      border-radius: 10px; box-shadow: 0 0 10px #ccc; text-align: right;
    }
    .judgment-container {
      display: flex; justify-content: center; align-items: center; margin: 14px 0; gap: 30px;
    }
    .judgment-column { width: 110px; text-align: center; font-weight: bold; }
    .judgment-meter {
      width: 40px; height: 220px; background-color: #ddd; border-radius: 20px; position: relative; overflow: hidden;
    }
    #judgmentIndicator {
      position: absolute; width: 100%; height: 0%; bottom: 0;
      background: linear-gradient(to top, #dc3545, #ffc107, #4caf50);
      transition: height 0.5s ease-in-out;
    }

    small.muted { color:#666; font-size:12px; }
  </style>
</head>
<body>
  <h1>ğŸ“– Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</h1>

  <div class="container">
    <!-- Ø§Ù„Ø­Ø³Ù†Ø§Øª -->
    <div class="column" id="good">
      <h2>âœ… Ø§Ù„Ø­Ø³Ù†Ø§Øª</h2>
      <select id="goodSelect">
        <option value="">Ø§Ø®ØªØ± Ø¹Ù…Ù„Ø§Ù‹ Ø­Ø³Ù†Ù‹Ø§</option>
      </select>
      <button onclick="addFromSelect('good')">Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>

      <input type="text" id="goodDesc" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ø¹Ù…Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <input type="number" id="goodPoints" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <button onclick="addEntry('good')">Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠÙ‹Ø§</button>

      <div class="helper">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ± ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø­Ø°ÙÙ‡.</div>
      <ul id="goodList"></ul>
      <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="goodTotal">0</span></strong>
    </div>

    <!-- Ø§Ù„Ø³ÙŠØ¦Ø§Øª -->
    <div class="column" id="bad">
      <h2>âŒ Ø§Ù„Ø³ÙŠØ¦Ø§Øª</h2>
      <select id="badSelect">
        <option value="">Ø§Ø®ØªØ± Ø³ÙŠØ¦Ø© (Ø®Ø§ØµØ© Ø¨Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±)</option>
      </select>
      <button onclick="addFromSelect('bad')">Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>

      <input type="text" id="badDesc" placeholder="Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ø§Ù„Ø³ÙŠØ¦Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <input type="number" id="badPoints" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <button onclick="addEntry('bad')">Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠÙ‹Ø§</button>

      <div class="helper">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ± ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø­Ø°ÙÙ‡.</div>
      <ul id="badList"></ul>
      <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="badTotal">0</span></strong>
    </div>
  </div>

  <div class="summary">âš–ï¸ Ø§Ù„ÙØ§Ø±Ù‚ = <span id="netResult">0</span> Ù†Ù‚Ø·Ø©</div>

  <!-- ØªØ°ÙƒÙŠØ± -->
  <div class="reminder-box">
    <h3>â˜ ï¸ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± â€“ ØªØ°ÙƒÙŠØ± ÙˆØªØ­Ø°ÙŠØ±</h3>
    <p id="reminderText">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„ØªØªØ°ÙƒØ± Ø§Ù„Ø¢Ø®Ø±Ø©...</p>
    <button onclick="showReminder()">Ø°ÙƒØ±Ù†ÙŠ Ø§Ù„ÙŠÙˆÙ…</button><br/>
    <small class="muted">Ø§Ù„Ù†ØµÙˆØµ Ù‡Ù†Ø§ Ù„Ù„ØªØ±Ø¨ÙŠØ© ÙˆØ§Ù„ØªØ°ÙƒÙŠØ± ÙˆÙ„ÙŠØ³Øª Ø£Ø­ÙƒØ§Ù…Ù‹Ø§ Ø´Ø±Ø¹ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø´Ø®Ø§Øµ.</small>
  </div>

  <!-- Ø¹Ø¯Ù‘Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± -->
  <div class="grave-meter-box">
    <h3>ğŸ“‰ Ø¹Ø¯Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±</h3>
    <div class="progress-container">
      <div id="graveProgress" class="progress-bar"></div>
    </div>
    <p id="graveLevel">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ø¢Ù…Ù†</p>
  </div>

  <!-- Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ®ÙÙŠÙ -->
  <div class="risk-mitigation-box">
    <h3>ğŸ›¡ï¸ ØªØ®ÙÙŠÙ Ø§Ù„Ø®Ø·Ø± (Ù…Ø±Ø© ÙƒÙ„ 24 Ø³Ø§Ø¹Ø© Ù„ÙƒÙ„ Ø®ÙŠØ§Ø±)</h3>
    <div class="mitigation-grid">
      <button onclick="applyMitigation('tawba')">ØªÙˆØ¨Ø© Ù†ØµÙˆØ­ Ø§Ù„Ø¢Ù†</button>
      <button onclick="applyMitigation('surahMulk')">Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ Ù„ÙŠÙ„Ø§Ù‹</button>
      <button onclick="applyMitigation('repayDebt')">Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ†/Ø±Ø¯ Ù…Ø¸Ù„Ù…Ø©</button>
      <button onclick="applyMitigation('cutNamimah')">Ù‚Ø·Ø¹ Ø§Ù„Ù†Ù…ÙŠÙ…Ø© ÙˆØ§Ù„ØªÙˆØ¨Ø©</button>
    </div>
    <small id="mitigationNote" class="muted">Ø§Ø®ØªØ± Ø¥Ø¬Ø±Ø§Ø¡Ù‹ Ù…Ù‚Ù„ÙÙ‘Ù„Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø®Ø·Ø±.</small>
  </div>

  <!-- Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
  <div class="final-judgment-box">
    <h3>ğŸŒŒ Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h3>
    <div class="judgment-container">
      <div class="judgment-column">ğŸŒ´ Ø§Ù„Ø¬Ù†Ø©</div>
      <div class="judgment-meter"><div id="judgmentIndicator"></div></div>
      <div class="judgment-column">ğŸ”¥ Ø§Ù„Ù†Ø§Ø±</div>
    </div>
    <p id="judgmentResult">â¬…ï¸ ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØµÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø£Ø¹Ù…Ø§Ù„Ùƒ...</p>
  </div>

<script>
  // -------- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© --------
  const goodActions = [
    { text: "ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± ÙÙŠ ÙˆÙ‚ØªÙ‡Ø§", points: 20 },
    { text: "Ø§Ù„ØµØ¯Ù‚Ø© Ø¹Ù„Ù‰ Ù…Ø­ØªØ§Ø¬", points: 15 },
    { text: "Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†", points: 10 },
    { text: "Ø¨Ø± Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†", points: 25 },
    { text: "Ø§Ù„Ø§Ø³ØªØºÙØ§Ø± 100 Ù…Ø±Ø©", points: 12 },
    { text: "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„", points: 18 },
    { text: "ØµÙ„Ø© Ø§Ù„Ø±Ø­Ù…", points: 16 }
  ];

  // Ø³ÙŠØ¦Ø§Øª Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± (Ù„Ù„ØªØ±Ø¨ÙŠØ© ÙÙ‚Ø·)
  const badActions = [
    { text: "Ø§Ù„Ù†Ù…ÙŠÙ…Ø© (Ù†Ù‚Ù„ Ø§Ù„ÙƒÙ„Ø§Ù… Ù„Ù„Ø¥ÙØ³Ø§Ø¯)", points: 15 },
    { text: "Ø¹Ø¯Ù… Ø§Ù„Ø§Ø³ØªÙ†Ø²Ø§Ù‡ Ù…Ù† Ø§Ù„Ø¨ÙˆÙ„", points: 15 },
    { text: "Ø§Ù„ÙƒØ°Ø¨ Ø§Ù„Ù…Ù†ØªØ´Ø± Ø§Ù„Ù…Ø¤Ø°ÙŠ", points: 20 },
    { text: "Ø§Ù„Ø²Ù†Ø§", points: 40 },
    { text: "ØªØ±Ùƒ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø§Ù„Ù‚Ø±Ø¢Ù†/Ù‡Ø¬Ø±Ù‡ Ø¨Ø¹Ø¯ Ù…Ø¹Ø±ÙØªÙ‡", points: 25 },
    { text: "Ø§Ù„ØºÙ„ÙˆÙ„/Ø£Ø®Ø° Ù…Ø§Ù„ Ø¹Ø§Ù… Ø¨ØºÙŠØ± Ø­Ù‚", points: 30 },
    { text: "Ø§Ù„Ø¯ÙÙ‘ÙŠÙ† Ù…Ø¹ Ø§Ù„Ù…Ù…Ø§Ø·Ù„Ø© ÙˆØ§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¯Ø§Ø¯", points: 20 }
  ];

  let goodTotal = 0;
  let badTotal  = 0;

  function populateDropdowns() {
    const g = document.getElementById("goodSelect");
    goodActions.forEach(a => {
      const opt = document.createElement("option");
      opt.value = a.points;
      opt.textContent = `${a.text} (+${a.points})`;
      g.appendChild(opt);
    });

    const b = document.getElementById("badSelect");
    badActions.forEach(a => {
      const opt = document.createElement("option");
      opt.value = a.points;
      opt.textContent = `${a.text} (-${a.points})`;
      b.appendChild(opt);
    });
  }

  // Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©
  function addFromSelect(type) {
    const sel = document.getElementById(type === 'good' ? 'goodSelect' : 'badSelect');
    const val = sel.value;
    if (!val) return;
    document.getElementById(type + 'Desc').value   = sel.options[sel.selectedIndex].textContent;
    document.getElementById(type + 'Points').value = val;
    addEntry(type);
    sel.selectedIndex = 0;
  }

  // Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠØ©/Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø§Ø¦Ø­Ø©
  function addEntry(type) {
    const descEl   = document.getElementById(`${type}Desc`);
    const pointsEl = document.getElementById(`${type}Points`);
    const desc   = (descEl.value || '').trim();
    const points = parseInt(pointsEl.value, 10);

    if (!desc || isNaN(points)) return;

    const list = document.getElementById(`${type}List`);
    const li = document.createElement('li');
    li.textContent = `${desc} (${points} Ù†Ù‚Ø·Ø©)`;
    li.title = "Ø§Ø¶ØºØ· Ù„Ù„Ø­Ø°Ù";
    li.onclick = () => {
      list.removeChild(li);
      if (type === 'good') {
        goodTotal -= points;
      } else {
        badTotal -= points;
      }
      updateAll();
    };
    list.appendChild(li);

    if (type === 'good') {
      goodTotal += points;
    } else {
      badTotal += points;
    }

    descEl.value = '';
    pointsEl.value = '';
    updateAll();
  }

  // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ù…Ù„
  function updateAll() {
    updateNetResult();
    updateGraveMeter();
    autoUpdateFinalJudgment();
  }

  // ØµØ§ÙÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·
  function updateNetResult() {
    const net = goodTotal - badTotal;
    document.getElementById('netResult').textContent = net;
  }

  // ØªØ°ÙƒÙŠØ± Ø¹Ø´ÙˆØ§Ø¦ÙŠ
  function showReminder() {
    const reminders = [
      "ÙƒØ§Ù† Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù† Ø¥Ø°Ø§ Ø°ÙÙƒØ± Ø§Ù„Ù‚Ø¨Ø± Ø¨ÙƒÙ‰ Ø­ØªÙ‰ ØªØ¨ØªÙ„ Ù„Ø­ÙŠØªÙ‡.",
      "Ø§Ù„Ù‚Ø¨Ø± Ø£ÙˆÙ„ Ù…Ù†Ø§Ø²Ù„ Ø§Ù„Ø¢Ø®Ø±Ø©ØŒ ÙØ¥Ù† Ù†Ø¬Ø§ Ù…Ù†Ù‡ ÙÙ…Ø§ Ø¨Ø¹Ø¯Ù‡ Ø£ÙŠØ³Ø±.",
      "Ø£ÙƒØ«Ø±ÙˆØ§ Ù…Ù† Ø°ÙƒØ± Ù‡Ø§Ø¯Ù… Ø§Ù„Ù„Ø°Ø§Øª: Ø§Ù„Ù…ÙˆØª.",
      "Ø§Ù„Ù„Ù‡Ù… Ù‚ÙÙ†Ø§ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±ØŒ ÙˆØ«Ø¨Ù‘ØªÙ†Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„.",
      "Ø§Ø³ØªØ¹Ø¯ÙˆØ§ Ù„Ù„Ù‚Ø¨Ø±ØŒ ÙØ¥Ù† Ø§Ù„Ù„ÙŠÙ„ ÙˆØ§Ù„Ù†Ù‡Ø§Ø± ÙŠØ¹Ù…Ù„Ø§Ù† ÙÙŠÙƒÙ…."
    ];
    const text = reminders[Math.floor(Math.random() * reminders.length)];
    document.getElementById('reminderText').textContent = text;
  }

  // -------- Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ®ÙÙŠÙ Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø± --------
  const K_GOOD = 0.6;                 // ÙˆØ²Ù† Ø§Ù„Ø­Ø³Ù†Ø§Øª ÙÙŠ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø®Ø·Ø±
  const DANGER_THRESHOLDS = [30, 60, 85]; // Ø¹ØªØ¨Ø§Øª Ø§Ù„ØªØ­Ø°ÙŠØ±
  const MITIGATION_POINTS = {
    tawba: 25,       // ØªÙˆØ¨Ø© Ù†ØµÙˆØ­ + Ø¥Ù‚Ù„Ø§Ø¹
    surahMulk: 10,   // Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ Ù„ÙŠÙ„Ø§Ù‹ (ØªÙ†Ø¨ÙŠÙ‡ ØªØ±Ø¨ÙˆÙŠ)
    repayDebt: 35,   // Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ†/Ø±Ø¯ Ù…Ø¸Ù„Ù…Ø©
    cutNamimah: 20   // Ù‚Ø·Ø¹ Ø§Ù„Ù†Ù…ÙŠÙ…Ø© ÙˆØ§Ù„ØªÙˆØ¨Ø©
  };

  let mitigationTotal = 0;

  function canUseMitigation(key){
    const usedAt = localStorage.getItem("mitigate_"+key);
    if(!usedAt) return true;
    const diffHrs = (Date.now() - parseInt(usedAt,10)) / (1000*60*60);
    return diffHrs >= 24;
  }
  function markMitigationUsed(key){
    localStorage.setItem("mitigate_"+key, Date.now().toString());
  }

  function applyMitigation(key){
    if(!MITIGATION_POINTS[key]) return;
    const noteEl = document.getElementById("mitigationNote");
    if(!canUseMitigation(key)){
      noteEl.textContent = "â³ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± 24 Ø³Ø§Ø¹Ø©. Ø¬Ø±Ù‘Ø¨ Ø®ÙŠØ§Ø±Ù‹Ø§ Ø¢Ø®Ø± Ø£Ùˆ Ø¹ÙØ¯ Ù„Ø§Ø­Ù‚Ù‹Ø§.";
      return;
    }
    mitigationTotal += MITIGATION_POINTS[key];
    markMitigationUsed(key);
    noteEl.textContent = "âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ®ÙÙŠÙ. Ø§Ø³ØªÙ…Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø© ÙˆØ§ØªØ±Ùƒ Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø®Ø·Ø±.";
    updateAll();
  }

  function computeGraveRisk(){
    // Ø®Ø·Ø± Ù…Ø¨Ø³Ø·: Ø³ÙŠØ¦Ø§Øª - (ÙˆØ²Ù†)*Ø­Ø³Ù†Ø§Øª - Ø§Ù„ØªØ®ÙÙŠÙ
    let risk = badTotal - K_GOOD * goodTotal - mitigationTotal;
    if (risk < 0)   risk = 0;
    if (risk > 100) risk = 100;
    return Math.round(risk);
  }

  function updateGraveMeter(){
    const levelText  = document.getElementById("graveLevel");
    const progressBar = document.getElementById("graveProgress");

    const risk = computeGraveRisk();  // 0..100
    progressBar.style.width = risk + "%";

    let label = "Ø¢Ù…Ù†";
    if (risk >= DANGER_THRESHOLDS[0] && risk < DANGER_THRESHOLDS[1]) label = "ØªØ­Ø°ÙŠØ± Ø¨Ø³ÙŠØ·";
    else if (risk >= DANGER_THRESHOLDS[1] && risk < DANGER_THRESHOLDS[2]) label = "Ø®Ø·Ø± Ù…ØªÙˆØ³Ø· âš ï¸";
    else if (risk >= DANGER_THRESHOLDS[2]) label = "Ø§Ù‚ØªØ±Ø§Ø¨ Ø´Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¹Ø°Ø§Ø¨ ğŸ˜Ÿ";

    levelText.textContent = `Ø§Ù„Ù…Ø³ØªÙˆÙ‰: ${label}`;

    const note = document.getElementById("mitigationNote");
    if (risk >= DANGER_THRESHOLDS[2]) {
      note.textContent = "ğŸš¨ Ø®Ø·Ø± Ø´Ø¯ÙŠØ¯! Ø§Ù‚ØªØ±Ø­: ØªÙˆØ¨Ø© Ù†ØµÙˆØ­ + Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ†/Ø±Ø¯ Ù…Ø¸Ù„Ù…Ø© Ø§Ù„Ø¢Ù†.";
    } else if (risk >= DANGER_THRESHOLDS[1]) {
      note.textContent = "âš ï¸ Ø®Ø·Ø± Ù…ØªÙˆØ³Ø·. Ø§Ù‚ØªØ±Ø­: Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ Ø§Ù„Ù„ÙŠÙ„Ø© + Ù‚Ø·Ø¹ Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø¹ØµÙŠØ©.";
    } else if (risk >= DANGER_THRESHOLDS[0]) {
      note.textContent = "ØªÙ†Ø¨ÙŠÙ‡: Ø¯Ø§ÙˆÙ… Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø§Ù„Ù…ØªÙˆØ§ØµÙ„Ø© Ù„ØªØ®ÙÙŠØ¶ Ø§Ù„Ù…Ø¤Ø´Ø±.";
    } else {
      note.textContent = "Ù…Ù…ØªØ§Ø². Ø¯Ø§ÙˆÙ… Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø§Øª ÙˆÙ†Ø¸Ù‘Ù ØµØ­ÙŠÙØªÙƒ Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±.";
    }
  }

  // -------- Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (Ù…Ø¤Ø´Ø± Ø±Ø£Ø³ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠ) --------
  function autoUpdateFinalJudgment() {
    const result = document.getElementById("judgmentResult");
    const indicator = document.getElementById("judgmentIndicator");
    const net = goodTotal - badTotal;
    let heightPercent = 50;

    if (net > 100) {
      result.textContent = "ğŸ¥‡ Ø£Ø¹Ù…Ø§Ù„Ùƒ Ø¹Ø¸ÙŠÙ…Ø©ØŒ ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø¬Ù†Ø© Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡!";
      heightPercent = 100;
    } else if (net > 50) {
      result.textContent = "ğŸŒ¿ Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ø¬Ù†Ø© Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø«Ø¨Ø§Øª.";
      heightPercent = 80;
    } else if (net > 0) {
      result.textContent = "ğŸ¤² Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­.";
      heightPercent = 65;
    } else if (net === 0) {
      result.textContent = "âš–ï¸ ØªØ¹Ø§Ø¯Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†.";
      heightPercent = 50;
    } else if (net > -30) {
      result.textContent = "â— Ø®Ø·Ø±! Ø±Ø§Ø¬Ø¹ Ù†ÙØ³Ùƒ Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†.";
      heightPercent = 35;
    } else if (net > -70) {
      result.textContent = "ğŸ”¥ ØªØ³Ø§Ø±Ø¹ Ù†Ø­Ùˆ Ø§Ù„Ø®Ø·Ø±ØŒ Ø¨Ø§Ø¯Ø± Ø¨Ø§Ù„ØªÙˆØ¨Ø©.";
      heightPercent = 20;
    } else {
      result.textContent = "ğŸš« Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ù†Ø§Ø± Ø¥Ù† Ù„Ù… ØªØªØ¨ØŒ Ø§Ù„Ù„Ù‡Ù… Ø³Ù„Ù…!";
      heightPercent = 5;
    }

    indicator.style.height = heightPercent + "%";
  }

  // Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø©
  window.onload = () => {
    populateDropdowns();
    updateAll();
  };
</script>
