<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ â€” ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©</title>
  <style>
    body{font-family:Tahoma,Arial,sans-serif;background:#f5f5f5;margin:0;padding:16px;text-align:center}
    h1{color:#2e7d32;margin:6px 0 10px}
    .row{display:flex;justify-content:center;gap:24px;flex-wrap:wrap}
    .card{background:#fff;padding:14px;border-radius:10px;box-shadow:0 0 8px rgba(0,0,0,.1);width:320px}
    input,select,button{width:90%;padding:8px;margin:4px 0;border:1px solid #ddd;border-radius:6px;font-size:14px}
    ul{list-style:none;margin:10px 0;padding:0;text-align:right;max-height:220px;overflow:auto}
    li{background:#e0f2f1;margin-bottom:6px;padding:8px;border-radius:6px;cursor:pointer}
    .muted{font-size:12px;color:#666}
    .summary{margin:10px 0 14px;font-weight:bold}
    /* ØªØ°ÙƒÙŠØ± */
    .rem{background:#fff3cd;color:#856404;border:1px solid #ffeeba}
    .rem button{background:#ffc107;border:none}
    /* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø¨Ø± */
    .grave{background:#fdecea;color:#611a15;border:1px solid #f5c6cb}
    .barWrap{background:#f8d7da;border-radius:20px;overflow:hidden;height:22px;margin:8px 0}
    .bar{height:100%;width:0%;background:#dc3545;transition:width .4s}
    /* Ø§Ù„ØªØ®ÙÙŠÙ */
    .miti{background:#eef7ff;color:#053b74;border:1px solid #cfe8ff}
    .miti .btns{display:flex;gap:6px;flex-wrap:wrap;justify-content:center}
    .miti .btns button{background:#1976d2;color:#fff;border:none;width:auto}
    /* Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ */
    .final{background:#e8f5e9;color:#1b5e20;border:1px solid #c8e6c9}
    .meterWrap{display:flex;justify-content:center;align-items:center;gap:18px;margin-top:8px}
    .meter{width:36px;height:200px;background:#ddd;border-radius:20px;position:relative;overflow:hidden}
    #judgmentIndicator{position:absolute;bottom:0;width:100%;height:0%;background:linear-gradient(to top,#dc3545,#ffc107,#4caf50);transition:height .4s}
    .colLbl{width:90px;font-weight:bold}
  </style>
</head>
<body>
  <h1>ğŸ“– Ù…ÙŠØ²Ø§Ù† Ø£Ø¹Ù…Ø§Ù„ÙŠ</h1>

  <!-- Ø§Ù„Ø­Ø³Ù†Ø§Øª ÙˆØ§Ù„Ø³ÙŠØ¦Ø§Øª -->
  <div class="row">
    <div class="card" id="good">
      <h2>âœ… Ø§Ù„Ø­Ø³Ù†Ø§Øª</h2>
      <select id="goodSelect"><option value="">Ø§Ø®ØªØ± Ø¹Ù…Ù„Ø§Ù‹ Ø­Ø³Ù†Ù‹Ø§</option></select>
      <button onclick="addFromSelect('good')">Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      <input id="goodDesc" type="text" placeholder="ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"/>
      <input id="goodPoints" type="number" placeholder="Ø¯Ø±Ø¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"/>
      <button onclick="addEntry('good')">Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠÙ‹Ø§</button>
      <div class="muted">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø¹Ù†ØµØ± Ù„Ø­Ø°ÙÙ‡</div>
      <ul id="goodList"></ul>
      <div><b>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</b> <span id="goodTotal">0</span></div>
    </div>

    <div class="card" id="bad">
      <h2>âŒ Ø§Ù„Ø³ÙŠØ¦Ø§Øª</h2>
      <select id="badSelect"><option value="">Ø§Ø®ØªØ± Ø³ÙŠØ¦Ø© (Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±)</option></select>
      <button onclick="addFromSelect('bad')">Ø¥Ø¶Ø§ÙØ© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      <input id="badDesc" type="text" placeholder="ÙˆØµÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"/>
      <input id="badPoints" type="number" placeholder="Ø¯Ø±Ø¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"/>
      <button onclick="addEntry('bad')">Ø¥Ø¶Ø§ÙØ© ÙŠØ¯ÙˆÙŠÙ‹Ø§</button>
      <div class="muted">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø¹Ù†ØµØ± Ù„Ø­Ø°ÙÙ‡</div>
      <ul id="badList"></ul>
      <div><b>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</b> <span id="badTotal">0</span></div>
    </div>
  </div>

  <!-- ØµØ§ÙÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· -->
  <div class="summary">âš–ï¸ Ø§Ù„ÙØ§Ø±Ù‚ = <span id="netResult">0</span> Ù†Ù‚Ø·Ø©</div>

  <!-- Ø§Ù„ØªØ°ÙƒÙŠØ± + Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚Ø¨Ø± + Ø§Ù„ØªØ®ÙÙŠÙ -->
  <div class="row">
    <div class="card rem">
      <h3>â˜ ï¸ ØªØ°ÙƒÙŠØ± Ø§Ù„Ù‚Ø¨Ø±</h3>
      <div id="reminderText" class="muted">Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„ØªØ°ÙƒÙŠØ±</div>
      <button onclick="showReminder()">Ø°ÙƒØ±Ù†ÙŠ Ø§Ù„ÙŠÙˆÙ…</button>
    </div>

    <div class="card grave">
      <h3>ğŸ“‰ Ø¹Ø¯Ø§Ø¯ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±</h3>
      <div class="barWrap"><div id="graveProgress" class="bar"></div></div>
      <div id="graveLevel">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: Ø¢Ù…Ù†</div>
    </div>

    <div class="card miti">
      <h3>ğŸ›¡ï¸ ØªØ®ÙÙŠÙ Ø§Ù„Ø®Ø·Ø± (24 Ø³Ø§Ø¹Ø©/Ø®ÙŠØ§Ø±)</h3>
      <div class="btns">
        <button onclick="applyMitigation('tawba')">ØªÙˆØ¨Ø© Ù†ØµÙˆØ­</button>
        <button onclick="applyMitigation('surahMulk')">Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ù„Ùƒ</button>
        <button onclick="applyMitigation('repayDebt')">Ø³Ø¯Ø§Ø¯ Ø¯ÙŠÙ†/Ø±Ø¯ Ù…Ø¸Ù„Ù…Ø©</button>
        <button onclick="applyMitigation('cutNamimah')">Ù‚Ø·Ø¹ Ø§Ù„Ù†Ù…ÙŠÙ…Ø©</button>
      </div>
      <div id="mitigationNote" class="muted">Ø§Ø®ØªØ± Ø¥Ø¬Ø±Ø§Ø¡Ù‹ Ø¹Ù†Ø¯ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø®Ø·Ø±.</div>
    </div>
  </div>

  <!-- Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
  <div class="row">
    <div class="card final" style="width:360px">
      <h3>ğŸŒŒ Ø§Ù„Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h3>
      <div class="meterWrap">
        <div class="colLbl">ğŸŒ´ Ø§Ù„Ø¬Ù†Ø©</div>
        <div class="meter"><div id="judgmentIndicator"></div></div>
        <div class="colLbl">ğŸ”¥ Ø§Ù„Ù†Ø§Ø±</div>
      </div>
      <div id="judgmentResult" class="muted">Ø§Ù„Ø­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø­Ø³Ø¨ Ø£Ø¹Ù…Ø§Ù„Ùƒ.</div>
    </div>
  </div>

<script>
  const goodActions = [
    { text: "ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± ÙÙŠ ÙˆÙ‚ØªÙ‡Ø§", points: 20 },
    { text: "Ø§Ù„ØµØ¯Ù‚Ø© Ø¹Ù„Ù‰ Ù…Ø­ØªØ§Ø¬", points: 15 },
    { text: "Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†", points: 10 },
    { text: "Ø¨Ø± Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†", points: 25 },
    { text: "Ø§Ù„Ø§Ø³ØªØºÙØ§Ø± 100 Ù…Ø±Ø©", points: 12 },
    { text: "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„", points: 18 },
    { text: "ØµÙ„Ø© Ø§Ù„Ø±Ø­Ù…", points: 16 }
  ];
  const badActions = [
    { text: "Ø§Ù„Ù†Ù…ÙŠÙ…Ø© (Ù†Ù‚Ù„ Ø§Ù„ÙƒÙ„Ø§Ù… Ù„Ù„Ø¥ÙØ³Ø§Ø¯)", points: 15 },
    { text: "Ø¹Ø¯Ù… Ø§Ù„Ø§Ø³ØªÙ†Ø²Ø§Ù‡ Ù…Ù† Ø§Ù„Ø¨ÙˆÙ„", points: 15 },
    { text: "Ø§Ù„ÙƒØ°Ø¨ Ø§Ù„Ù…Ù†ØªØ´Ø± Ø§Ù„Ù…Ø¤Ø°ÙŠ", points: 20 },
    { text: "Ø§Ù„Ø²Ù†Ø§", points: 40 },
    { text: "ØªØ±Ùƒ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø§Ù„Ù‚Ø±Ø¢Ù†/Ù‡Ø¬Ø±Ù‡ Ø¨Ø¹Ø¯ Ù…Ø¹Ø±ÙØªÙ‡", points: 25 },
    { text: "Ø§Ù„ØºÙ„ÙˆÙ„/Ø£Ø®Ø° Ù…Ø§Ù„ Ø¹Ø§Ù… Ø¨ØºÙŠØ± Ø­Ù‚", points: 30 },
    { text: "Ø§Ù„Ø¯ÙÙ‘ÙŠÙ† Ù…Ø¹ Ø§Ù„Ù…Ù…Ø§Ø·Ù„Ø© ÙˆØ§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¯Ø§Ø¯", points: 20 }
  ];
  let goodTotal = 0, badTotal = 0;
  const K_GOOD = 0.6;
  const DANGER_THRESHOLDS = [30,60,85];
  const MITIGATION_POINTS = {tawba:25,surahMulk:10,repayDebt:35,cutNamimah:20};
  let mitigationTotal = 0;

  function populateDropdowns(){
    const g = document.getElementById('goodSelect');
    goodActions.forEach(a=>{
      const o=document.createElement('option');o.value=a.points;o.textContent=`${a.text} (+${a.points})`;g.appendChild(o);
    });
    const b = document.getElementById('badSelect');
    badActions.forEach(a=>{
      const o=document.createElement('option');o.value=a.points;o.textContent=`${a.text} (-${a.points})`;b.appendChild(o);
    });
  }
  function addFromSelect(type){
    const sel = document.getElementById(type==='good'?'goodSelect':'badSelect');
    if(!sel.value) return;
    document.getElementById(type+'Desc').value = sel.options[sel.selectedIndex].textContent;
    document.getElementById(type+'Points').value = sel.value;
    addEntry(type);
    sel.selectedIndex = 0;
  }
  function addEntry(type){
    const desc=(document.getElementById(`${type}Desc`).value||'').trim();
    const points=parseInt(document.getElementById(`${type}Points`).value,10);
    if(!desc || isNaN(points)) return;
    const list=document.getElementById(`${type}List`);
    const li=document.createElement('li');
    li.textContent=`${desc} (${points} Ù†Ù‚Ø·Ø©)`;
    li.onclick=()=>{list.removeChild(li); if(type==='good'){goodTotal-=points;} else {badTotal-=points;} updateAll();};
    list.appendChild(li);
    if(type==='good'){goodTotal+=points;} else {badTotal+=points;}
    document.getElementById(`${type}Desc`).value='';document.getElementById(`${type}Points`).value='';
    updateAll();
  }
  function updateAll(){updateNetResult();updateGraveMeter();autoUpdateFinalJudgment();}
  function updateNetResult(){document.getElementById('netResult').textContent = goodTotal - badTotal;}
  function showReminder(){
    const arr=[
      "ÙƒØ§Ù† Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù† Ø¥Ø°Ø§ Ø°ÙÙƒØ± Ø§Ù„Ù‚Ø¨Ø± Ø¨ÙƒÙ‰ Ø­ØªÙ‰ ØªØ¨ØªÙ„ Ù„Ø­ÙŠØªÙ‡.",
      "Ø§Ù„Ù‚Ø¨Ø± Ø£ÙˆÙ„ Ù…Ù†Ø§Ø²Ù„ Ø§Ù„Ø¢Ø®Ø±Ø©ØŒ ÙØ¥Ù† Ù†Ø¬Ø§ Ù…Ù†Ù‡ ÙÙ…Ø§ Ø¨Ø¹Ø¯Ù‡ Ø£ÙŠØ³Ø±.",
      "Ø£ÙƒØ«Ø±ÙˆØ§ Ù…Ù† Ø°ÙƒØ± Ù‡Ø§Ø¯Ù… Ø§Ù„Ù„Ø°Ø§Øª: Ø§Ù„Ù…ÙˆØª.",
      "Ø§Ù„Ù„Ù‡Ù… Ù‚ÙÙ†Ø§ Ø¹Ø°Ø§Ø¨ Ø§Ù„Ù‚Ø¨Ø±ØŒ ÙˆØ«Ø¨Ù‘ØªÙ†Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø³Ø¤Ø§Ù„.",
      "Ø§Ø³ØªØ¹Ø¯ÙˆØ§ Ù„Ù„Ù‚Ø¨Ø±ØŒ ÙØ¥Ù† Ø§Ù„Ù„ÙŠÙ„ ÙˆØ§Ù„Ù†Ù‡Ø§Ø± ÙŠØ¹Ù…Ù„Ø§Ù† ÙÙŠÙƒÙ…."
    ];
    document.getElementById('reminderText').textContent = arr[Math.floor(Math.random()*arr.length)];
  }
  function canUseMitigation(k){
    const t=localStorage.getItem('mitigate_'+k);
    if(!t) return true;
    return ((Date.now()-parseInt(t,10))/(1000*60*60))>=24;
  }
  function markMitigationUsed(k){localStorage.setItem('mitigate_'+k,Date.now().toString());}
  function applyMitigation(k){
    const note=document.getElementById('mitigationNote');
    if(!MITIGATION_POINTS[k]) return;
    if(!canUseMitigation(k)){note.textContent="â³ Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ø³ØªÙØ®Ø¯Ù… Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©.";return;}
    mitigationTotal+=MITIGATION_POINTS[k];
    markMitigationUsed(k);
    note.textContent="âœ… ØªÙ… Ø§Ù„ØªØ®ÙÙŠÙ. Ø§Ø«Ø¨Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ø¹Ø©.";
    updateAll();
  }
  function computeGraveRisk(){
    let risk=badTotal - K_GOOD*goodTotal - mitigationTotal;
    if(risk<0) risk=0;if(risk>100) risk=100;
    return Math.round(risk);
  }
  function updateGraveMeter(){
    const risk=computeGraveRisk();
    document.getElementById('graveProgress').style.width = risk + '%';
    let label="Ø¢Ù…Ù†";
    if(risk>=DANGER_THRESHOLDS[0] && risk<DANGER_THRESHOLDS[1]) label="ØªØ­Ø°ÙŠØ± Ø¨Ø³ÙŠØ·";
    else if(risk>=DANGER_THRESHOLDS[1] && risk<DANGER_THRESHOLDS[2]) label="Ø®Ø·Ø± Ù…ØªÙˆØ³Ø· âš ï¸";
    else if(risk>=DANGER_THRESHOLDS[2]) label="Ø§Ù‚ØªØ±Ø§Ø¨ Ø´Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¹Ø°Ø§Ø¨ ğŸ˜Ÿ";
    document.getElementById('graveLevel').textContent="Ø§Ù„Ù…Ø³ØªÙˆÙ‰: "+label;
  }
  function autoUpdateFinalJudgment(){
    const net = goodTotal - badTotal;
    let h=50, txt="Ø§Ù„Ø­Ø³Ø§Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø­Ø³Ø¨ Ø£Ø¹Ù…Ø§Ù„Ùƒ.";
    if(net>100){h=100;txt="ğŸ¥‡ Ø£Ø¹Ù…Ø§Ù„Ùƒ Ø¹Ø¸ÙŠÙ…Ø©ØŒ ÙˆØ¬Ù‡ØªÙƒ Ø§Ù„Ø¬Ù†Ø© Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡!";}
    else if(net>50){h=80;txt="ğŸŒ¿ Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ø¬Ù†Ø© Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø«Ø¨Ø§Øª.";}
    else if(net>0){h=65;txt="ğŸ¤² Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ØŒ ÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØµØ§Ù„Ø­.";}
    else if(net===0){h=50;txt="âš–ï¸ ØªØ¹Ø§Ø¯Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨ØŒ ÙÙƒÙ† Ù…Ù† Ø§Ù„Ù…Ø³ØªØºÙØ±ÙŠÙ†.";}
    else if(net>-30){h=35;txt="â— Ø®Ø·Ø±! Ø±Ø§Ø¬Ø¹ Ù†ÙØ³Ùƒ Ù‚Ø¨Ù„ ÙÙˆØ§Øª Ø§Ù„Ø£ÙˆØ§Ù†.";}
    else if(net>-70){h=20;txt="ğŸ”¥ ØªØ³Ø§Ø±Ø¹ Ù†Ø­Ùˆ Ø§Ù„Ø®Ø·Ø±ØŒ Ø¨Ø§Ø¯Ø± Ø¨Ø§Ù„ØªÙˆØ¨Ø©.";}
    else {h=5;txt="ğŸš« Ù…ØµÙŠØ±Ùƒ Ø§Ù„Ù†Ø§Ø± Ø¥Ù† Ù„Ù… ØªØªØ¨ØŒ Ø§Ù„Ù„Ù‡Ù… Ø³Ù„Ù…!";}
    document.getElementById('judgmentIndicator').style.height = h + '%';
    document.getElementById('judgmentResult').textContent = txt;
  }
  window.onload=function(){populateDropdowns();updateAll();}
</script>
</body>
</html>
